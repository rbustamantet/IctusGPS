<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Estenosis carot√≠dea</title>
<link rel="icon" type="image/png" sizes="192x192" href="../iconos/ictusgps.png">
<link rel="apple-touch-icon" sizes="180x180" href="../iconos/ictusgps.png">
<meta name="theme-color" content="#0f3d83">

<style>
:root{
  --bg:#f8fafc;--ink:#0f172a;--borde:#e5e7eb;
  --ok:#166534;--ok-bg:#e9fce7;--ok-ring:#bbf7d0;
  --mid:#92400e;--mid-bg:#fff7ed;--mid-ring:#fed7aa;
  --bad:#991b1b;--bad-bg:#fef2f2;--bad-ring:#fecaca;
  --accent:#2563eb;
  --bg:#f8fafc; 
  --ink:#0e1a33;

  --azul:#0f3d83;
  --azul-institucional:#0f3d83;

  --accent-dark:#0f3d83;
  --accent-light:#2563eb;

  --border:#e5e9f2;
  --muted:#64748b;

  --ok:#166534;
  --ok-bg:#e9fce7;
  --ok-ring:#bbf7d0;

  --mid:#92400e;
  --mid-bg:#fff7ed;
  --mid-ring:#fed7aa;

  --bad:#991b1b;
  --bad-bg:#fef2f2;
  --bad-ring:#fecaca;

  --gris:#6b7280;
  --borde:#e5e7eb;
  --error:#b91c1c;

  --card:#ffffff;
  --shadow:rgba(15,23,42,.06);
}


*{box-sizing:border-box}
html,body{
  margin:0;
  padding:0;
  background:var(--bg);
  color:var(--ink);
  font-family: Verdana, Geneva, Tahoma, sans-serif
}
.wrap{max-width:1100px;margin:0 auto;padding:calc(env(safe-area-inset-top) + 60px);}

/* =========================================================
   SAFE-TOP (FIJO 60 px + notch)
========================================================= */
.safe-top {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: calc(env(safe-area-inset-top) + 60px);
  background: var(--azul-institucional);
  z-index: 1001;
  display: flex;
  align-items: flex-start;
  justify-content: center;
  padding-top: env(safe-area-inset-top);
}

.safe-content{
  width:100%;
  max-width:1080px;
  padding: 6px 16px 8px;
  display:flex;
  justify-content:space-between;
  align-items:flex-start;
}

.safe-left{
  display:flex;
  align-items:center;
  gap:10px;
}

.safe-mini{
  width:44px;
  height:44px;
  object-fit:contain;
  padding:4px;
  box-shadow:0 0 4px rgba(0,0,0,0.1);
}

.safe-logo{
  height:44px;
  width:auto;
}

.safe-actions{
  display:flex;
  gap:10px;
}

.safe-btn{
  display:inline-flex;
  align-items:center;
  justify-content:center;
  width:40px;
  height:40px;
  background:rgba(255,255,255,0.15);
  border:1px solid white;
  border-radius:50%;
  transition:background .25s, border-color .25s, transform .1s;
}

.safe-btn:hover{
  background:#01c5fe;
}

.safe-btn:active{
  transform:scale(0.95);
}

.safe-icon{
  width:32px; 
  height:32px;
  object-fit:contain;
}

/* =========================================================
   CABECERA STICKY
========================================================= */
header{
  position:sticky;
  top:calc(env(safe-area-inset-top) + 52px);
  z-index:1002;
  backdrop-filter:blur(6px);
  background:var(--azul-institucional);
  border-bottom:1px solid rgba(255,255,255,.08);
  box-shadow:0 2px 6px rgba(0,0,0,0.08);
  color:#fff;
}

.bar{
  display:flex;
  justify-content:center;
  align-items:center;
  gap:10px;
  height:52px;
  padding:0 16px;
}

.title{
  display:flex;
  align-items:center;
  font-size:1.4rem;
  font-weight:700;
  color:#fff;
}

.title img{
  width:32px;
  height:32px;
  margin-right:8px;
}


/* BLOQUES */
.howto{
  background:#fff;
  border:1px solid var(--border);
  border-radius:14px;
  box-shadow:0 2px 2px var(--shadow);
  padding:1rem;
  margin:.3rem 0 1rem;
  font-size:14px
}
.wrap{max-width:1100px;margin:16px auto 48px;padding:calc(env(safe-area-inset-top) + 60px) 16px}

.panel{background:#fff;border:1px solid var(--borde);border-radius:16px;padding:16px;box-shadow:0 2px 10px rgba(15,23,42,.06)}
.block{border-radius:14px;padding:14px 16px;margin:14px 0;transition:background .3s}
.block h3{margin:0 0 8px 0;font-size:1.05rem;font-weight:800;display:flex;align-items:center;gap:6px}
.block.rope{background:#eff6ff;border-left:4px solid #3b82f6}   /* azul */
.block.anat{background:#ecfdf5;border-left:4px solid #10b981}  /* verde */
.block.clin{background:#fffbeb;border-left:4px solid #f59e0b} /* amarillo */
.block.info{background:#ffffff;border-left:4px solid #000}

.block:hover{box-shadow:0 2px 6px rgba(0,0,0,.08)}
.note{color:#64748b;font-size:12px;margin:6px 0 12px}
label{font-weight:400;color:#1e293b;margin-top:8px;display:block}
select{width:100%;padding:10px 12px;border:1px solid #cbd5e1;border-radius:10px;background:#fff;font-size:14px}
.grid{display:grid;gap:10px}
@media(min-width:860px){.grid.cols-2{grid-template-columns:1fr 1fr}}
.check{display:flex;align-items:flex-start;gap:8px;margin:6px 0;color:#1e293b;font-weight:400;transition:color .2s}
.check:hover{color:#0f3d83}
.check input{margin-top:2px;transform:scale(1.05);accent-color:#0f3d83}

/* Radios en l√≠nea para NASCET */
.inline-options{
  display:flex;gap:16px;flex-wrap:wrap;align-items:center;margin-top:6px
}
.inline-options .check{margin:0}

/* RESULTADOS */
.kpi{display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-top:10px}
.box{border:1.5px dashed #c7dbff;border-radius:14px;padding:14px;background:#f8fbff;text-align:center}
.ttl{font-size:14px;color:#334155;font-weight:800;margin-bottom:2px}
.val{font-size:22px;font-weight:900;color:#0b2c5f}
.mini{font-size:12px;color:#64748b;margin-top:4px}
.ok{background:var(--ok-bg);border-color:var(--ok-ring)}
.warn{background:var(--mid-bg);border-color:var(--mid-ring)}
.bad{background:var(--bad-bg);border-color:var(--bad-ring)}
.ok .val{color:var(--ok)}.warn .val{color:var(--mid)}.bad .val{color:var(--bad)}

/* BOTONES */
.actions{display:flex;gap:10px;flex-wrap:wrap;margin-top:0px}
.btn-action{flex:1 1 32%;border:none;border-radius:10px;padding:12px;font-size:15px;font-weight:700;cursor:pointer}
.btn-clear{background:#fff;color:#0b2c5f;border:1px solid #2563eb}
.btn-clear:hover{background:#eff6ff}
.btn-copy{background:#fff;color:#0f3d83;border:1px solid #2563eb}
.btn-copy:hover{background:#eff6ff}
.btn-copy.copiado{background:#0f3d83!important;color:#fff!important}
.btn-calc{background:#0f3d83;color:#fff;border:1px solid #0f3d83}
.btn-calc:hover{background:#1c60c3}




/* OTROS */
#resumenText{white-space:pre-wrap;font-size:13px;color:#0f172a;margin-top:12px;border:1px dashed var(--borde);border-radius:10px;padding:10px 12px;background:#f8fafc;line-height:1.45}
.disclaimer-red{
  background:#fef2f2;border:1px solid #fecaca;border-radius:12px;
  padding:14px 16px;margin:18px 0 0 0;box-shadow:0 2px 8px rgba(185,28,28,0.05)
}
.disclaimer-red p{margin:0;color:#7f1d1d;font-size:14px;line-height:1.5;text-align:left}
.disclaimer-red b{color:#991b1b}
footer{position:relative;left:50%;transform:translateX(-50%);width:100vw;margin:2rem 0 0 0;padding:1.5rem 0;border-top:1px solid #e5e7eb;background:#ffffff;text-align:center;box-shadow:0 -2px 6px rgba(0,0,0,.04)}

.item-condicion {
  display: flex;
  align-items: center;
  gap: 6px;
  position: relative;
  margin: 6px 0;
  font-family: Verdana, Geneva, Tahoma, sans-serif;
}

.texto-cond {
  flex: 1;
  color: #0f172a;
}

/* Icono ‚ÑπÔ∏è */
.info-icon {
  display: inline-block;
  font-size: 0.8rem;
  background-color: #e0ebff;
  color: #0f3d83;
  border-radius: 50%;
  width: 18px;
  height: 18px;
  text-align: center;
  line-height: 18px;
  font-weight: bold;
  cursor: pointer;
  transition: background-color 0.2s ease, transform 0.15s;
}
.info-icon:hover,
.info-icon:focus {
  background-color: #c9dcff;
  transform: scale(1.1);
}

/* Tooltip */
.tooltiptext {
  visibility: hidden;
  width: 280px;
  background-color: #0f3d83;
  color: #f8fafc;
  text-align: left;
  border-radius: 12px;
  padding: 10px 12px;
  position: absolute;
  z-index: 10;
  bottom: 130%;
  left: 30px;
  opacity: 0;
  transition: opacity 0.25s ease-in-out;
  font-size: 0.8rem;
  line-height: 1.35;
  box-shadow: 0 3px 10px rgba(15, 61, 131, 0.25);
  border: 1px solid rgba(255,255,255,0.2);
}
.item-condicion .tooltiptext::after {
  content: "";
  position: absolute;
  top: 100%;
  left: 35px;
  border-width: 6px;
  border-style: solid;
  border-color: #0f3d83 transparent transparent transparent;
}
.info-icon:hover + .texto-cond + .tooltiptext,
.info-icon:focus + .texto-cond + .tooltiptext {
  visibility: visible;
  opacity: 1;
}

/* Versi√≥n m√≥vil */
@media (max-width: 600px){
  .tooltiptext {
    width: 90vw;
    left: 50%;
    transform: translateX(-50%);
    font-size: 0.85rem;
  }
  .item-condicion .tooltiptext::after {
    left: 50%;
    transform: translateX(-50%);
  }
}
</style>
</head>

<body>
<!-- SAFE-TOP -->
<div class="safe-top">
  <div class="safe-content">
    <div class="safe-left">
      <img src="../iconos/utilidadesico.png" alt="Icono Utilidades" class="safe-mini">
      <img src="../img/topbar.png" alt="IctusGPS" class="safe-logo">
    </div>
    <div class="safe-actions">
      <a href="javascript:history.back()" class="safe-btn" title="Volver atr√°s">
        <img src="../iconos/atrastransparente.png" alt="Atr√°s" class="safe-icon">
      </a>
      <a href="../index.html" class="safe-btn" title="Volver al inicio">
        <img src="../iconos/hometransparente.png" alt="Inicio" class="safe-icon">
      </a>
    </div>
  </div>
</div>

<header>
  <div class="bar">
    <div class="title"><img src="estenosisico.png" alt="Estenosis carot√≠dea">Estenosis carot√≠dea</div>
      </div>
</header>


<main class="wrap">
<div class="howto">
    Integra situaci√≥n cl√≠nica, caracter√≠sticas de la placa/anatom√≠a y grado de estenosis (NASCET) para orientar la indicaci√≥n de <b>antiagregaci√≥n</b>, <b>DAPT</b>, <b>endarterectom√≠a (CEA)</b> o <b>stent carot√≠deo (CAS)</b>. No c√°lculo autom√°tico: usa ‚ÄúCalcular‚Äù.
  </div>
</div>
<section class="panel">

<!-- BLOQUE CL√çNICO -->
<div class="block rope">
  <h3>ü©∫ Situaci√≥n cl√≠nica</h3>
  <div class="grid cols-2">
    <div>
      <label><b>Cl√≠nica neurol√≥gica</b></label>
      <label class="check"><input type="radio" name="clin" id="sxReciente"> Ictus/AIT ‚â§14 d√≠as</label>
      <label class="check"><input type="radio" name="clin" id="sxAntiguo"> Ictus/AIT &gt;14 d√≠as</label>
      <label class="check"><input type="radio" name="clin" id="asint"> Asintom√°tica</label>
    </div>

    <div>
      <label><b>Condiciones generales</b></label>

      <div class="item-condicion">
        <input type="checkbox" id="contraInterv">
        <span class="info-icon" tabindex="0">‚ÑπÔ∏è</span>
        <span class="texto-cond">Contraindicaci√≥n para intervenir</span>
        <div class="tooltiptext">
          Situaci√≥n m√©dica o anat√≥mica que impide la revascularizaci√≥n 
          (p. ej. fragilidad extrema, comorbilidad severa, otras).
        </div>
      </div>

      <div class="item-condicion">
        <input type="checkbox" id="expVida5">
        <span class="info-icon" tabindex="0">‚ÑπÔ∏è</span>
        <span class="texto-cond">Expectativa de vida ‚â•5 a√±os</span>
        <div class="tooltiptext">
          Paciente con buena situaci√≥n funcional y esperanza de vida suficiente 
          para beneficiarse del tratamiento preventivo de revascularizaci√≥n.
        </div>
      </div>

      <div class="item-condicion">
        <input type="checkbox" id="riesgoCEAbajo">
        <span class="info-icon" tabindex="0">‚ÑπÔ∏è</span>
        <span class="texto-cond">Riesgo perioperatorio CEA bajo</span>
        <div class="tooltiptext">
          Probabilidad estimada de complicaciones neurol√≥gicas o muerte 
          dentro de los l√≠mites aceptables para considerar endarterectom√≠a carot√≠dea 
          (‚â§6% sintom√°ticos, ‚â§3% asintom√°ticos).
        </div>
      </div>
    </div>
  </div>
</div>

<!-- BLOQUE PLACA / ANATOM√çA -->
<div class="block anat">
  <h3>üåÄ Caracter√≠sticas de la placa y anatom√≠a</h3>
  <div class="grid cols-2">

    <div class="item-condicion">
      <input type="checkbox" id="placaUlcerada">
      <span class="info-icon" tabindex="0">‚ÑπÔ∏è</span>
      <span class="texto-cond">Placa ulcerada o irregular</span>
      <div class="tooltiptext">
        Superficie de la placa con ulceraci√≥n o irregularidad luminal. 
        Indica inestabilidad y mayor riesgo emb√≥lico.
      </div>
    </div>

    <div class="item-condicion">
      <input type="checkbox" id="placaBlanda">
      <span class="info-icon" tabindex="0">‚ÑπÔ∏è</span>
      <span class="texto-cond">Placa hipodensa o heterog√©nea o hemorr√°gica</span>
      <div class="tooltiptext">
        Placa blanda o con contenido lip√≠dico o hemorr√°gico en imagen. 
        Asociada a vulnerabilidad y riesgo de progresi√≥n.
      </div>
    </div>

    <div class="item-condicion">
      <input type="checkbox" id="trombo">
      <span class="info-icon" tabindex="0">‚ÑπÔ∏è</span>
      <span class="texto-cond">Trombo adherido</span>
      <div class="tooltiptext">
        Presencia de material tromb√≥tico adherido a la placa. 
        Riesgo elevado de embolia cerebral oclusiva.
      </div>
    </div>

    <div class="item-condicion">
      <input type="checkbox" id="estenosisBilateral">
      <span class="info-icon" tabindex="0">‚ÑπÔ∏è</span>
      <span class="texto-cond">Estenosis bilateral</span>
      <div class="tooltiptext">
        Afectaci√≥n significativa de ambas arterias car√≥tidas. 
        Aumenta riesgo de hipoperfusi√≥n y complica la estrategia de revascularizaci√≥n.
      </div>
    </div>

    <div class="item-condicion">
      <input type="checkbox" id="oclContralateral">
      <span class="info-icon" tabindex="0">‚ÑπÔ∏è</span>
      <span class="texto-cond">Oclusi√≥n contralateral</span>
      <div class="tooltiptext">
        Car√≥tida opuesta totalmente ocluida. 
        Reduce la circulaci√≥n colateral y eleva el riesgo quir√∫rgico de endarterectom√≠a.
      </div>
    </div>

    <div class="item-condicion">
      <input type="checkbox" id="reestenosisCEA">
      <span class="info-icon" tabindex="0">‚ÑπÔ∏è</span>
      <span class="texto-cond">Reestenosis tras CEA</span>
      <div class="tooltiptext">
        Nueva estenosis en el sitio de una endarterectom√≠a previa. 
        Suele deberse a hiperplasia intimal o recurrencia ateroscler√≥tica.
      </div>
    </div>

    <div class="item-condicion">
      <input type="checkbox" id="radRT">
      <span class="info-icon" tabindex="0">‚ÑπÔ∏è</span>
      <span class="texto-cond">Estenosis por radioterapia cervical</span>
      <div class="tooltiptext">
        Lesi√≥n posradiaci√≥n con fibrosis o alteraci√≥n anat√≥mica del cuello (hostil). 
        Aumenta el riesgo quir√∫rgico y suele preferirse abordaje endovascular.
      </div>
    </div>

    <div class="item-condicion">
      <input type="checkbox" id="altoRiesgoQx">
      <span class="info-icon" tabindex="0">‚ÑπÔ∏è</span>
      <span class="texto-cond">Alto riesgo quir√∫rgico</span>
      <div class="tooltiptext">
        Condiciones m√©dicas o anat√≥micas que incrementan la morbimortalidad 
        de una cirug√≠a abierta (cardiopat√≠a grave, cuello hostil, edad avanzada).
      </div>
    </div>

    <div class="item-condicion">
      <input type="checkbox" id="altoRiesgoEndo">
      <span class="info-icon" tabindex="0">‚ÑπÔ∏è</span>
      <span class="texto-cond">Dificultad endovascular local</span>
      <div class="tooltiptext">
        Tortuosidad o calcificaci√≥n en el trayecto carot√≠deo que dificulta 
        el avance o posicionamiento del stent, sin afectar el acceso proximal.
      </div>
    </div>

    <div class="item-condicion">
      <input type="checkbox" id="aortaHostil">
      <span class="info-icon" tabindex="0">‚ÑπÔ∏è</span>
      <span class="texto-cond">Aorta o troncos supraa√≥rticos hostiles</span>
      <div class="tooltiptext">
        Arco a√≥rtico elongado (tipo III) o calcificado y troncos de salida tortuosos. 
        Dificulta el acceso endovascular desde el arco hacia la car√≥tida.
      </div>
    </div>

    <div class="item-condicion">
      <input type="checkbox" id="cervicalAlta">
      <span class="info-icon" tabindex="0">‚ÑπÔ∏è</span>
      <span class="texto-cond">Estenosis carot√≠dea cervical alta</span>
      <div class="tooltiptext">
        Lesi√≥n localizada muy alta (por encima del √°ngulo mandibular), 
        de dif√≠cil exposici√≥n quir√∫rgica. Puede preferirse abordaje endovascular.
      </div>
    </div>

    <div class="item-condicion">
      <input type="checkbox" id="intraStent">
      <span class="info-icon" tabindex="0">‚ÑπÔ∏è</span>
      <span class="texto-cond">Estenosis intrastent</span>
      <div class="tooltiptext">
        Reestenosis dentro de un stent carot√≠deo previo. 
        Generalmente manejable con nueva angioplastia o stent.
      </div>
    </div>

    <div class="item-condicion">
      <input type="checkbox" id="distalPresente">
      <span class="info-icon" tabindex="0">‚ÑπÔ∏è</span>
      <span class="texto-cond">Estenosis distal ipsilateral no tratable</span>
      <div class="tooltiptext">
        Estenosis significativa en territorio intracraneal distal a la lesi√≥n carot√≠dea. 
        Limita el beneficio de la revascularizaci√≥n cervical.
      </div>
    </div>

    <div class="item-condicion">
      <input type="checkbox" id="distalTratable">
      <span class="info-icon" tabindex="0">‚ÑπÔ∏è</span>
      <span class="texto-cond">Estenosis distal ipsilateral tratable</span>
      <div class="tooltiptext">
        Lesi√≥n intracraneal asociada pero susceptible de tratamiento endovascular, 
        permitiendo abordaje combinado (‚Äút√°ndem tratable‚Äù).
      </div>
    </div>

  </div>
</div>
<!-- BLOQUE GRADO -->
<div class="block clin">
  <h3>üìà Grado de estenosis (NASCET)</h3>
  <div class="inline-options" role="group" aria-label="Grado NASCET">
    <label class="check"><input type="radio" name="grado" id="glt50"> &lt;50%</label>
    <label class="check"><input type="radio" name="grado" id="g50a69"> 50‚Äì69%</label>
    <label class="check"><input type="radio" name="grado" id="g70a99"> 70‚Äì99%</label>
    <label class="check"><input type="radio" name="grado" id="gOclusion"> Oclusi√≥n total</label>
  </div>
</div>

<!-- BOTONES -->
<div class="actions">
  <button id="btnCalc" class="btn-action btn-calc">Calcular</button>
  <button id="btnClear" class="btn-action btn-clear">Borrar</button>
  <button id="btnCopy" class="btn-action btn-copy">Copiar resumen</button>
</div>

<!-- RESULTADOS -->
<div class="panel" id="resultCard" style="margin-top:16px;display:none;">
  <div class="kpi">
    <div class="box" id="kClin"><div class="ttl">Clasificaci√≥n</div><div class="val" id="valClin">-</div></div>
    <div class="box" id="kGrado"><div class="ttl">Grado</div><div class="val" id="valGrado">-</div></div>
  </div>

  <div class="kpi">
    <div class="box" id="kRiesgo"><div class="ttl">Riesgo</div><div class="val" id="valRiesgo">-</div><div class="mini" id="miniRiesgo">-</div></div>
    <div class="box" id="kTandem"><div class="ttl">T√°ndem</div><div class="val" id="valTandem">-</div><div class="mini" id="miniTandem">-</div></div>
  </div>

  <!-- Recomendaci√≥n ocupa todo el ancho -->
  <div style="margin-top:12px;">
    <div class="box" id="recBox">
      <div class="ttl">Recomendada</div>
      <div class="val" id="recVal">-</div>
      <div class="mini" id="recNote">-</div>
      <div class="mini" id="postTx">-</div> <!-- tratamiento asociado/postprocedimiento -->
    </div>
  </div>

  <div class="kpi" style="margin-top:12px;">
    <div class="box" id="contraBox"><div class="ttl">Contraindicada</div><div class="val" id="contraVal">-</div></div>
    <div class="box" id="prefBox"><div class="ttl">Preferencia local</div><div class="val" id="prefVal">-</div><div class="mini">La elecci√≥n final depender√° de la morbimortalidad y experiencia del centro.</div></div>
  </div>

<div id="resumenText" class="resumen" style="white-space:pre-line; margin-top:1rem; border-top:1px dashed #e5e7eb; padding-top:1rem;"></div>

  <div class="disclaimer-red">
    <p><b>Advertencia.</b> Herramienta orientativa; no sustituye el juicio cl√≠nico ni el consenso multidisciplinar. Interpretar en el contexto individual, protocolos locales y gu√≠as (AHA/ASA, ESO).</p>
  </div>
</div>

<!-- DETALLES -->
<details style="margin-top:16px;">
  <summary style="cursor:pointer;font-weight:700;color:#0f3d83;">üìã Explicaci√≥n de √≠tems</summary>
  <div style="margin-top:8px;font-size:13px;line-height:1.5;color:#1e293b;">
    <b>Cl√≠nica:</b> ictus/AIT ‚â§14 d√≠as = prioridad de intervenci√≥n; >14 d√≠as = beneficio menor; asintom√°tica = considerar ‚â•70% con riesgo operatorio bajo y expectativa de vida &ge;5 a√±os.<br>
    <b>Placa/Anatom√≠a:</b> ulcerada/trombo/hipodensa/hemorragia intraplaca = alto riesgo emb√≥lico; radioterapia, reestenosis pos-CEA, cervical alta e intrastent = <i>cuello hostil</i> (favorece CAS). Oclusi√≥n contralateral aumenta riesgo en CEA. Lesi√≥n distal intracraneal cr√≠tica no tratable: descarta beneficio de CEA/CAS; si tratable endovascularmente, favorece CAS en abordaje combinado.<br>
    <b>Grado NASCET:</b> &lt;50% = manejo m√©dico; 50‚Äì69% = beneficio selectivo; 70‚Äì99% = beneficio claro en sintom√°ticos.
  </div>
</details>

</section>
<div style="text-align:center;">
  <a href="index.html" class="back-btn">Volver</a>
</div>
</main>

<script>
const $=id=>document.getElementById(id);

function getClinica(){
  if ($('sxReciente').checked) return 'Sintom√°tica ‚â§14d';
  if ($('sxAntiguo').checked)  return 'Sintom√°tica >14d';
  if ($('asint').checked)      return 'Asintom√°tica';
  return '';
}
function getGrado(){
  if ($('glt50').checked)   return '<50%';
  if ($('g50a69').checked)  return '50‚Äì69%';
  if ($('g70a99').checked)  return '70‚Äì99%';
  if ($('gOclusion').checked) return 'Oclusi√≥n total';
  return '';
}
function bool(id){ const el=$(id); return el && el.checked; }

function riesgoMorfologico(){
  const altos = ['placaUlcerada','trombo','placaBlanda'].filter(id=>bool(id)).length;
  if (altos>=2) return {txt:'Alto', mini:'Placa inestable (‚â•2 rasgos)'};
  if (altos===1) return {txt:'Intermedio', mini:'Un rasgo de inestabilidad'};
  return {txt:'Bajo', mini:'Sin rasgos de alto riesgo'};
}

function tandemInfo(){
  const distal = bool('distalPresente');
  const trat   = bool('distalTratable');
  if (!distal) return {txt:'No', mini:'Sin lesi√≥n distal'};
  return {txt: trat?'S√≠ (tratable)':'S√≠ (no tratable)', mini: trat?'Abordaje endovascular posible':'Descarta beneficio de CEA/CAS'};
}

function calcular(){
  const clin = getClinica();
  const grado = getGrado();

  if (!clin || !grado){
    $('resultCard').style.display='none';
      }

  const contraInterv = bool('contraInterv');
  const expVida5     = bool('expVida5');
  const riesgoCEAb   = bool('riesgoCEAbajo');

  const placaUlcerada=bool('placaUlcerada');
  const trombo=bool('trombo');
  const placaBlanda=bool('placaBlanda');

  const oclContra=bool('oclContralateral');
  const radRT=bool('radRT');
  const reCEA=bool('reestenosisCEA');
  const altoEndo=bool('altoRiesgoEndo');    
  const altoQxBase=bool('altoRiesgoQx');
  const cervicalAlta=bool('cervicalAlta');
  const intraStent=bool('intraStent');
  const distal=bool('distalPresente');
  const distalTratable=bool('distalTratable');
  const aortaHostil=bool('aortaHostil');    

  const cuelloHostil = (altoQxBase || radRT || reCEA || cervicalAlta || intraStent || oclContra);
  const riesgo = riesgoMorfologico();
  const tandem = tandemInfo();

  let rec='-', note='-', contra='-', pref='-';
  let post='-';
  let tone='warn';
  let tagDAPT=false;

  // Exclusiones iniciales
  if (grado==='Oclusi√≥n total'){
    rec='Tratamiento m√©dico √≥ptimo';
    note='Oclusi√≥n completa: sin beneficio de revascularizaci√≥n';
    contra='CEA y CAS';
    pref='‚Äî';
    post='AS (AAS o clopidogrel) indefinida + estatina alta y control FRV';
    tone='bad';
  }
  else if (distal && !distalTratable){
    rec='Tratamiento m√©dico (AS o DAPT seg√∫n cl√≠nica)';
    note='Lesi√≥n distal intracraneal cr√≠tica no tratable';
    contra='CEA y CAS';
    pref='‚Äî';
    post= (clin.startsWith('Sintom√°tica')) ? 'DAPT 21‚Äì30 d√≠as ‚Üí monoterapia indefinida' : 'AS (AAS o clopidogrel) indefinida';
    tagDAPT=true;
    tone='bad';
  }
  else if (contraInterv){
    rec='Antiagregaci√≥n simple';
    note='No candidato a intervenci√≥n';
    post='AS (AAS o clopidogrel) indefinida';
    contra='CEA y CAS';
    pref='‚Äî';
    tone='bad';
  } else {
    const esSintoRec = clin==='Sintom√°tica ‚â§14d';
    const esSintoAnt = clin==='Sintom√°tica >14d';
    const esAsinto   = clin==='Asintom√°tica';

    // ======= CONTROL GLOBAL (prioridad de conflicto) =======
    if (aortaHostil && radRT){
      rec='Tratamiento m√©dico optimizado';
      note='Aorta/troncos hostiles + cuello irradiado: CEA y CAS desaconsejadas';
      contra='CEA y CAS';
      pref='‚Äî';
      post='AS (AAS o clopidogrel) indefinida + estatina alta y control FRV';
      tone='bad';
    }
    else if (altoEndo && cuelloHostil){
      rec='Tratamiento m√©dico optimizado';
      note='Cuello hostil (CEA contraindicada) + dificultad endovascular local (CAS desaconsejada)';
      contra='CEA y CAS';
      pref='‚Äî';
      post='AS (AAS o clopidogrel) indefinida + estatina alta y control FRV';
      tone='bad';
    }
    else if (radRT){
      rec='CAS preferible';
      note='Cuello irradiado: alto riesgo quir√∫rgico';
      contra='CEA';
      pref='CAS indicada';
      post='Tras CAS: DAPT 1‚Äì3 meses ‚Üí monoterapia indefinida';
      tone='ok';
    }
    else if (aortaHostil){
      rec='CEA preferible';
      note='Acceso endovascular dificultoso (aorta calcificada/elonga. tipo III): evitar CAS';
      contra='CAS';
      pref='CEA indicada';
      post='Tras CEA: AAS indefinido';
      tone='ok';
    }

    // ======= SINTOM√ÅTICAS =======
    else if (esSintoRec || esSintoAnt){
      if (grado==='70‚Äì99%'){
        if (altoEndo){
          rec='CEA preferible';
          note='Anatom√≠a carot√≠dea tortuosa/calcificada: CAS desaconsejada';
          contra='CAS';
          pref='CEA indicada';
          post='Tras CEA: AAS indefinido';
          tone='ok';
        }
        else if (cuelloHostil){
          rec='CAS recomendada';
          note='Alto riesgo quir√∫rgico/cuello hostil';
          contra='CEA';
          pref='CAS indicada';
          post='Tras CAS: DAPT 1‚Äì3 m ‚Üí monoterapia indefinida';
          tone='ok';
        } else {
          rec='CEA o CAS (ambas posibles)';
          note='Beneficio alto en sintom√°ticos';
          contra='Ninguna';
          pref='CEA si riesgo ‚â§6%; CAS si cuello hostil';
          post='CEA‚ÜíAAS indef. ¬∑ CAS‚ÜíDAPT 1‚Äì3 m ‚Üí monoterapia';
          tone='ok';
        }
      } else if (grado==='50‚Äì69%'){
        if (placaUlcerada || trombo || placaBlanda){
          rec='DAPT temporal (21‚Äì30 d√≠as) ‚Üí monoterapia';
          note='Placa inestable; beneficio moderado sin intervenci√≥n inmediata';
          contra='CEA y CAS';
          post='Tras DAPT: AAS o clopidogrel indefinido';
          tagDAPT=true;
          tone='warn';
        } else {
          rec='Manejo m√©dico';
          note='Beneficio limitado; individualizar';
          contra='CEA y CAS';
          post='AS (AAS o clopidogrel) indefinida';
          tone='bad';
        }
      } else { 
        rec='Antiagregaci√≥n simple';
        note='Estenosis <50% no significativa';
        contra='CEA y CAS';
        post='AS (AAS o clopidogrel) indefinida';
        tone='bad';
      }
    } 

    // ======= ASINTOM√ÅTICAS =======
    else if (esAsinto){
      if (grado==='Oclusi√≥n total'){
        rec='Tratamiento m√©dico';
        note='Oclusi√≥n completa: no indicada revascularizaci√≥n';
        contra='CEA y CAS';
        post='AS o clopidogrel indefinido';
        tone='bad';
      }
      else if (grado==='<50%'){
        rec='Tratamiento m√©dico';
        note='Estenosis leve sin indicaci√≥n';
        contra='CEA y CAS';
        post='AS o clopidogrel indefinido';
        tone='bad';
      }
      else if (grado==='50‚Äì69%'){
        if (placaUlcerada || trombo){
          rec='DAPT temporal (21‚Äì30 d√≠as) ‚Üí monoterapia';
          note='Placa de alto riesgo emb√≥lico asintom√°tica';
          contra='Ninguna';
          post='DAPT 21‚Äì30 d ‚Üí monoterapia indefinida';
          tagDAPT=true;
          tone='warn';
        } else {
          rec='Tratamiento m√©dico √≥ptimo';
          note='Beneficio incierto de revascularizaci√≥n';
          contra='CEA y CAS';
          post='AS o clopidogrel indefinido';
          tone='bad';
        }
      }
      else if (grado==='70‚Äì99%'){
        if (!expVida5){
          rec='Tratamiento m√©dico';
          note='Expectativa <5 a√±os: sin beneficio duradero';
          contra='CEA y CAS';
          post='AS o clopidogrel indefinido';
          tone='bad';
        }
        else if (altoEndo){
          rec='CEA preferible';
          note='Anatom√≠a carot√≠dea tortuosa/calcificada: CAS desaconsejada';
          contra='CAS';
          pref='CEA indicada';
          post='Tras CEA: AAS indefinido';
          tone='ok';
        }
        else if (oclContra){
          if (altoEndo){
            rec='Manejo m√©dico o CEA selectiva';
            note='Oclusi√≥n contralateral y dificultad endovascular: CAS descartada';
            contra='CAS';
            pref='MDT';
            post='AS indefinida (si CEA: AAS indefinido)';
            tone='warn';
          } else {
            rec='CAS preferible';
            note='Oclusi√≥n contralateral: preferible abordaje endovascular';
            contra='CEA';
            pref='CAS indicada';
            post='Tras CAS: DAPT 1‚Äì3 m ‚Üí monoterapia indefinida';
            tone='ok';
          }
        }
        else if (placaUlcerada || trombo){
          rec='CEA o CAS (ambas posibles); considerar DAPT temporal';
          note='Placa ulcerada o trombo mural (alto riesgo emb√≥lico)';
          contra='Ninguna';
          post='DAPT 21‚Äì30 d ‚Üí monoterapia indefinida';
          tagDAPT=true;
          tone='warn';
        }
        else{
          rec='CEA o CAS (ambas posibles)';
          note='Asintom√°tica ‚â•70%, beneficio mayor si >80‚Äì85%';
          contra='Ninguna';
          pref='CEA si riesgo ‚â§3%; CAS si cuello hostil';
          post='CEA‚ÜíAAS indef. ¬∑ CAS‚ÜíDAPT 1‚Äì3 m ‚Üí monoterapia';
          tone='ok';
        }
      }
    }
  }

  // ---- Mostrar resultados ----
  $('valClin').textContent = clin;
  $('valGrado').textContent = grado;

  const rM = riesgoMorfologico();
  const tI = tandemInfo();
  $('valRiesgo').textContent = rM.txt;
  $('miniRiesgo').textContent = rM.mini;
  $('valTandem').textContent = tI.txt;
  $('miniTandem').textContent = tI.mini;

  $('recVal').textContent = rec;
  $('recNote').textContent = note;
  $('postTx').textContent = post;
  $('contraVal').textContent = contra;
  $('prefVal').textContent = (rec.includes('CEA o CAS') || rec.includes('Valorar')) ? (pref || 'Seg√∫n morbimortalidad y experiencia local') : (pref || '‚Äî');

  const toneClass = (tone==='ok')?'ok':(tone==='warn')?'warn':'bad';
  ['recBox','contraBox','prefBox'].forEach(id=>{
    const el=$(id); el.classList.remove('ok','warn','bad'); el.classList.add(toneClass);
  });


  // ---- Etiqueta DAPT temporal ----
  let tag = $('tagDAPT');
  if (!tag){
    tag = document.createElement('div');
    tag.id='tagDAPT';
    tag.style.background='#fef3c7';
    tag.style.border='1px solid #facc15';
    tag.style.borderRadius='8px';
    tag.style.color='#854d0e';
    tag.style.fontSize='0.9rem';
    tag.style.fontWeight='500';
    tag.style.padding='6px 10px';
    tag.style.marginTop='10px';
    tag.style.display='none';
    $('recBox').appendChild(tag);
  }
  tag.style.display = tagDAPT ? 'block' : 'none';
  if (tagDAPT) tag.textContent='üí° DAPT temporal (21‚Äì30 d√≠as) ‚Üí monoterapia indefinida';

  // ---- Resumen para copiar ----
  let resumen = `Estenosis carot√≠dea ‚Äî Recomendaci√≥n\n`;
  resumen += `=========================\n`;
  resumen += `Cl√≠nica: ${clin}\nGrado (NASCET): ${grado}\n`;
  resumen += `Placa/Imagen: ${rM.txt} (${rM.mini})\n`;
  resumen += `T√°ndem: ${tI.txt}${tI.mini? ' ‚Äî ' + tI.mini : ''}\n\n`;
  resumen += `Tratamiento recomendado: ${rec}\n`;
  resumen += `Nota: ${note}\n`;
  resumen += `T√©cnica contraindicada: ${contra}\n`;
  if (rec.includes('CEA o CAS') || rec.includes('Valorar')) {
    resumen += `Preferencia local: ${$('prefVal').textContent}\n`;
  }
  resumen += `Tratamiento asociado/postprocedimiento: ${post}\n`;
  resumen += `\nAviso: herramienta orientativa; ajustar a protocolos locales y discusi√≥n MDT.`;
  $('resumenText').textContent = resumen;

  $('resultCard').style.display='block';
}

function borrar(){
  ['sxReciente','sxAntiguo','asint','glt50','g50a69','g70a99','gOclusion'].forEach(id=>{ const el=$(id); if(el) el.checked=false; });
  ['contraInterv','expVida5','riesgoCEAbajo','placaUlcerada','trombo','placaBlanda','estenosisBilateral','oclContralateral','radRT','reestenosisCEA','altoRiesgoEndo','altoRiesgoQx','cervicalAlta','intraStent','distalPresente','distalTratable','aortaHostil'].forEach(id=>{ const el=$(id); if(el) el.checked=false; });
  $('resultCard').style.display='none';
  const tag=$('tagDAPT'); if(tag) tag.style.display='none';
  $('resumenText').textContent = '';
}

function copiar(){
  const t=$('resumenText').textContent.trim();
  if(!t) return;
  navigator.clipboard.writeText(t).then(()=>{
    const b=$('btnCopy');
    if(!b) return;
    b.classList.add('copiado');
    b.textContent='Copiado';
    setTimeout(()=>{b.classList.remove('copiado');b.textContent='Copiar resumen';},1200);
  });
}

$('btnCalc').addEventListener('click',calcular);
$('btnClear').addEventListener('click',borrar);
const btnCopyEl = $('btnCopy');
if (btnCopyEl) btnCopyEl.addEventListener('click',copiar);
</script>






<footer>
  <img src="uibanner.png" alt="Unidad de Ictus M√°laga" style="max-width:380px;height:auto;opacity:.96">
</footer>
<script src="js/index.js"></script>
<script>
  (function(){
    const btn = document.getElementById('backIcon');
    if(!btn) return;

    btn.addEventListener('click', function(){
      // Solo activo en ordenador (mouse o trackpad)
      const isDesktop = window.matchMedia("(pointer: fine)").matches;
      if(!isDesktop) return;

      console.log('[IctusGPS] Bot√≥n atr√°s pulsado. Historial:', window.history.length);
      if (window.history.length > 1) history.back();
      else window.location.href = '../index.html';
    });
  })();
</script>
</body>
</html>
