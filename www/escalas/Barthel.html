<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
<meta name="theme-color" content="#0f3d83">
<title>Escala de Barthel</title>

<!-- ICONOS Y MANIFIESTO -->
<link rel="manifest" href="../site.webmanifest">
<link rel="icon" type="image/png" sizes="192x192" href="../iconos/ictusgps.png">
<link rel="apple-touch-icon" sizes="180x180" href="../iconos/ictusgps.png">
<link rel="shortcut icon" href="../iconos/ictusgps.png">

<style>
:root{
  --bg:#f9fafc;
  --ink:#0e1a33;
  --accent-dark:#0f3d83;
  --accent-light:#2563eb;
  --border:#e5e9f2;
  --muted:#64748b;
  --ok:#166534; --ok-bg:#e9fce7; --ok-ring:#bbf7d0;
  --mid:#92400e; --mid-bg:#fff7ed; --mid-ring:#fed7aa;
  --bad:#991b1b; --bad-bg:#fef2f2; --bad-ring:#fecaca;
  --azul-institucional:#0f3d83;
}

/* =========================================================
   SAFE-TOP
========================================================= */
.safe-top {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: calc(env(safe-area-inset-top, 0px) + 60px);
  background: var(--azul-institucional);
  z-index: 1001;
  display: flex;
  align-items: flex-start;
  justify-content: center;
  padding-top: env(safe-area-inset-top, 0px);
}
.safe-content {
  width: 100%;
  max-width: 1080px;
  padding: 6px 16px 8px;
  display: flex;
  justify-content: space-between;
  align-items: flex-start; 
  /* A√±adir un padding-top para empujar los iconos ligeramente hacia abajo y no pegarlos al borde */
  padding-top: 5px; /* Ajuste manual para bajar los iconos un poco */
  padding-bottom: 0; /* Eliminar padding inferior para reservar ese espacio */
}
.safe-left {
  display: flex;
  align-items: center;
  gap: 10px;
}
.safe-mini {
  width: 44px;
  height: 44px;
  object-fit: contain;
  padding: 4px;
  box-shadow: 0 0 4px rgba(0,0,0,0.1);
}
.safe-logo {
  height: 44px;
  width: auto;
}
.safe-actions {
  display: flex;
  gap: 10px;
}
.safe-btn {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 40px;
  height: 40px;
  background: rgba(255,255,255,0.15);
  border: 1px solid white;
  border-radius: 50%;
  transition: background .25s, border-color .25s, transform .1s;
}
.safe-btn:hover {
  background: #01c5fe;
  border: 1px solid white;
}
.safe-btn:active { transform: scale(0.95); }
.safe-icon {
  width: 32px;
  height: 32px;
  object-fit: contain;
}
/* =========================================================
   CABECERA INFERIOR (STICKY)
========================================================= */
header {
  position: sticky;
  top: calc(env(safe-area-inset-top, 0px) + 52px);
  z-index: 1002;
  backdrop-filter: blur(6px);
  background: var(--accent-dark);
  border-bottom: 1px solid rgba(255,255,255,.08);
  box-shadow: 0 2px 6px rgba(0,0,0,0.08);
  color: #fff;
}
.bar {
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 10px;
  height: 52px;
  padding: 0 16px;
}
.title {
  font-size: 1.4rem;
  font-weight: 700;
  color: #fff;
}
/* =========================================================
   CABECERA
========================================================= */
/* ... (reglas existentes) ... */
.bar {
  display:flex;
  justify-content:center;
  align-items:center;
  gap: 10px;
  height:52px;
  padding:4px 16px;
}

.title {
  display: flex; /* <-- NUEVO: Habilita flexbox para alinear el icono */
  align-items: center; /* <-- NUEVO: Centra el icono y el texto verticalmente */
  /* ... (otras reglas de title) ... */
}
.title img {
  width: 32px; /* Define el tama√±o del icono */
  height: 32px;
  margin-right: 8px; /* Espacio entre el icono y el texto "ABCD¬≤" */
}

.pill{
  display:inline-flex; align-items:center; justify-content:center;
  min-width:38px; height:25px; padding:6px 10px;
  border-radius:999px; font-size:13px; font-weight:700;
  border:1px solid transparent; background:#dbeafe; color:#1e3a8a;
  white-space:nowrap; overflow:hidden; text-overflow:ellipsis;
}
.pill-ok   {background:#dcfce7; color:#065f46; border-color:#86efac;}
.pill-warn {background:#fef3c7; color:#92400e; border-color:#fde68a;}
.pill-bad  {background:#fee2e2; color:#991b1b; border-color:#fecaca;}

*{box-sizing:border-box}
html,body{
  margin:0;
  padding:0;
  background:var(--bg);
  color:var(--ink);
  font-family:Verdana, Geneva, sans-serif;
}

/* =========================================================
   CONTENIDO PRINCIPAL
========================================================= */

.container{max-width:980px;margin:16px auto 48px;padding:2px 16px;}


.card{background:#fff;border:1px solid var(--border);border-radius:16px;padding:8px;box-shadow:0 2px 10px rgba(15,23,42,.06);}
label{font-size:15px;font-weight:700;display:block;margin-bottom:6px;color:var(--accent-dark);}
select{width:100%;border:1px solid var(--border);border-radius:10px;padding:12px;font-size:15px;background:#fff;}
.item{margin-bottom:14px;}
.result{display:none;}
.result.show{display:block;}
.kpi{display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-top:4px;}
.box{border:1px dashed var(--border);border-radius:12px;padding:12px;text-align:center;}
.ttl{font-size:13px;color:var(--muted);}
.val{font-size:22px;font-weight:700;color:var(--accent-dark);}
.classBox{margin-top:12px;border-radius:12px;padding:12px 14px;font-weight:700;text-align:center;}
.err{display:none;border-radius:12px;padding:12px 14px;margin-top:10px;background:#fef2f2;color:var(--bad);border:1px solid var(--bad-ring);}
.actions{display:flex;gap:10px;flex-wrap:wrap;margin-top:18px;}
.btn-secondary{
  flex:1 1 48%;border:1px solid #0f3d83;border-radius:10px;padding:12px;
  font-size:15px;font-weight:700;background:#fff;color:#0f3d83;cursor:pointer;
  transition:all 0.25s ease;
}
.btn-secondary:hover{background:#e6ecff;}
.btn-secondary.copiado{background:#0f3d83!important;color:#fff!important;border-color:#0f3d83!important;}
.hint{font-size:12px;color:var(--muted);margin-top:4px;}
#resumenText {
  white-space: pre-wrap;
  font-size: 13px;
  color: #0f172a;
  margin-top: 10px;
  border: 1px dashed var(--border);
  border-radius: 10px;
  padding: 10px 12px;
  background: #f8fafc;
  line-height: 1.45;
}

/* INTRO */
.howto{
  background:#fff;
  border:1px solid var(--border);
  border-radius:14px;
  box-shadow:0 2px 2px var(--muted);
  padding:.5rem;
  margin:.5rem 0 1rem;
  font-size:14px;
}

/* =========================================================
   FOOTER
========================================================= */
/* Pie */
footer{
  width:100%;
  margin:2rem 0 0;
  padding:1.5rem 0;
  border-top:1px solid #e5e7eb;
  background:#ffffff;
  text-align:center;
  box-shadow:0 -2px 6px rgba(0,0,0,0.04);
}
footer img{max-width:320px;height:auto;opacity:.95}

/* =========================================================
   PADDING SUPERIOR DEL CONTENIDO
========================================================= */

/* Empuja el contenido real por debajo de la barra superior */
body {
  margin: 0;
  padding-top: calc(env(safe-area-inset-top, 0px) + 52px);
  background-color: #fff;
}

@media(max-width:768px){
  header{font-size:1.05rem;}
  main{padding:0.9rem 1rem;}
  body{font-size:0.96rem;}
}

</style>
</head>

<body>
<!-- SAFE-TOP -->
<div class="safe-top">
  <div class="safe-content">
    <div class="safe-left">
      <img src="../iconos/escalasico.png" alt="Icono Escalas" class="safe-mini">
      <img src="../img/topbar.png" alt="IctusGPS" class="safe-logo">
    </div>
    <div class="safe-actions">
      <a href="javascript:history.back()" class="safe-btn" title="Volver atr√°s">
        <img src="../iconos/atrastransparente.png" alt="Atr√°s" class="safe-icon">
      </a>
      <a href="../index.html" class="safe-btn" title="Volver al inicio">
        <img src="../iconos/hometransparente.png" alt="Inicio" class="safe-icon">
      </a>
    </div>
  </div>
</div>

<header>
  <div class="bar">
    <div class="title"><img src="../iconos/barthel.png" alt="Barthel">Barthel</div>
    <output id="pill" class="pill">‚Äî</output>
  </div>
</header>


<main class="container">
<div class="howto">Eval√∫a la <strong>independencia funcional</strong> en las actividades b√°sicas de la vida diaria (ABVD), puntuando la capacidad del paciente para realizar diez tareas cotidianas como comer, asearse, vestirse o deambular. La puntuaci√≥n total oscila entre <strong>0 y 100</strong>, donde valores m√°s altos indican mayor autonom√≠a. Complete los campos seleccionando el nivel de independencia en cada √≠tem.</div>

  <div class="card">
    <form id="calcForm"><div id="campos"></div></form>
  </div>

  <div id="resultCard" class="card result">
    <div id="errBox" class="err" role="alert"></div>
    <div class="kpi">
      <div class="box"><div class="ttl">Puntuaci√≥n total (0‚Äì100)</div><div class="val" id="totalVal">‚Äî</div></div>
      <div class="box"><div class="ttl">√çtems completados</div><div class="val"><span id="filledVal">0</span> / 10</div></div>
    </div>
    <div id="classBox" class="classBox" aria-live="polite">‚Äî</div>
    <div class="actions">
      <button id="btnBorrar" type="button" class="btn-secondary">Borrar</button>
      <button id="btnCopiar" type="button" class="btn-secondary">Copiar resumen</button>
    </div>
    <div id="resumenText" aria-label="Resumen generado para copiar"></div>
    <p class="hint">El resumen incluye puntuaci√≥n, clasificaci√≥n e √≠tems seleccionados.</p>
  </div>
</main>

<script>
// ====== CAMPOS ======
const items = [
  ["comer","Comer",["Independiente (la comida est√° al alcance)",10],["Necesita ayuda",5],["Incapaz de alimentarse",0]],
  ["traslado","Traslado (silla/cama)",["Independiente",15],["Necesita alguna ayuda",10],["Ayuda importante",5],["Incapaz",0]],
  ["aseo","Aseo personal",["Independiente",5],["Dependiente",0]],
  ["retrete","Uso del retrete",["Independiente",10],["Necesita ayuda",5],["Dependiente",0]],
  ["bano","Ba√±o/ducha",["Independiente",5],["Dependiente",0]],
  ["deambular","Deambular",["Independiente ‚â•50 m",15],["Ayuda m√≠nima",10],["Silla ruedas (50 m)",5],["Inm√≥vil",0]],
  ["escaleras","Escaleras",["Independiente",10],["Necesita ayuda",5],["Incapaz",0]],
  ["vestirse","Vestirse",["Independiente",10],["Ayuda parcial",5],["Dependiente",0]],
  ["heces","Control de heces",["Continente",10],["Accidente ocasional",5],["Incontinente",0]],
  ["orina","Control de orina",["Continente",10],["Accidente ocasional",5],["Incontinente",0]]
];
const camposDiv=document.getElementById("campos");
items.forEach(([id,label,...opts])=>{
  const div=document.createElement("div");
  div.className="item";
  div.innerHTML=`<label for="${id}">${label}</label><select id="${id}">${opts.map(([txt,val])=>`<option value="${val}">${txt}</option>`).join('')}</select>`;
  camposDiv.appendChild(div);
});

function clasificarBarthel(T){
  if(T<=20) return 'Dependencia total';
  if(T<=60) return 'Dependencia severa';
  if(T<=90) return 'Dependencia moderada';
  if(T<=99) return 'Dependencia leve';
  return 'Independiente';
}
function clasePill(clase){
  if(/Independiente|leve/i.test(clase)) return 'pill-ok';
  if(/moderada|severa/i.test(clase)) return 'pill-warn';
  return 'pill-bad';
}
function calcular(){
  const ids=items.map(i=>i[0]);
  let total=0,filled=0;
  ids.forEach(id=>{
    const el=document.getElementById(id);
    const v=Number(el.value||0);
    if(el.selectedIndex>=0){total+=v;filled++;}
  });
  const resultCard=document.getElementById('resultCard');
  const totalVal=document.getElementById('totalVal');
  const filledVal=document.getElementById('filledVal');
  const classBox=document.getElementById('classBox');
  resultCard.classList.add('show');
  const clase=clasificarBarthel(total);
  totalVal.textContent=total;
  filledVal.textContent=filled;
  classBox.textContent=clase;
  classBox.style.background=filled<10?'#fff':(
    /Independiente|leve/i.test(clase)?'#dcfce7':
    /moderada|severa/i.test(clase)?'#fef3c7':'#fee2e2');
  classBox.style.color=filled<10?'#000':(
    /Independiente|leve/i.test(clase)?'#065f46':
    /moderada|severa/i.test(clase)?'#92400e':'#991b1b');
  const pill=document.getElementById('pill');
  pill.className='pill '+clasePill(clase);
  pill.textContent=filled<10?'‚Äî':total;
}
function borrar(){
  items.forEach(([id])=>document.getElementById(id).selectedIndex=0);
  calcular();
// üîµ Scroll al inicio suavemente
  window.scrollTo({
    top: 0,
    behavior: "smooth"
  });
}
function copiar(){
  const total=document.getElementById('totalVal').textContent;
  const clase=document.getElementById('classBox').textContent;
  const resumenDiv=document.getElementById('resumenText');
  if(total==='‚Äî'||!total.trim())return;
  let texto=`Escala de Barthel: ${total} puntos (${clase}).\n\nDetalle por √≠tems:\n`;
  items.forEach(([id,nombre,...opciones])=>{
    const sel=document.getElementById(id);
    const opt=sel.options[sel.selectedIndex];
    const valor=opt?opt.value:''; const desc=opt?opt.textContent:'';
    texto+=`- ${nombre}: ${desc} (${valor})\n`;
  });
  texto+=`\nInterpretaci√≥n: `;
  if(/Independiente/i.test(clase)) texto+='Independencia funcional casi completa.';
  else if(/leve/i.test(clase)) texto+='Leve dependencia para algunas ABVD.';
  else if(/moderada/i.test(clase)) texto+='Dependencia moderada, precisa ayuda parcial frecuente.';
  else if(/severa/i.test(clase)) texto+='Dependencia severa, ayuda continua en la mayor√≠a de las actividades.';
  else texto+='Dependencia total para las actividades b√°sicas.';
  resumenDiv.textContent=texto;
  navigator.clipboard.writeText(texto).then(()=>{
    const btn=document.getElementById('btnCopiar');
    btn.classList.add('copiado');
    btn.textContent='Copiado';
    setTimeout(()=>{
      btn.classList.remove('copiado');
      btn.textContent='Copiar resumen';
    },3000);
  });
}
items.forEach(([id])=>{
  const el=document.getElementById(id);
  el.addEventListener('change',calcular);
  el.addEventListener('input',calcular);
});
document.getElementById('btnBorrar').addEventListener('click',borrar);
document.getElementById('btnCopiar').addEventListener('click',copiar);
document.addEventListener('DOMContentLoaded',calcular);
</script>

<footer>
  <img src="../img/uibanner.png" alt="Ictus GPS">
</footer>
<script src="js/index.js"></script>
</body>
</html>
