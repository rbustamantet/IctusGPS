<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="manifest" href="../site.webmanifest">
<link rel="icon" type="image/png" sizes="192x192" href="../iconos/ictusgps.png">
<link rel="apple-touch-icon" sizes="180x180" href="../iconos/ictusgps.png">
<link rel="shortcut icon" href="../iconos/ictusgps.png">
<meta name="theme-color" content="#0f3d83">
<title>CHA‚ÇÇDS‚ÇÇ-VA ‚Äî Riesgo de ictus en fibrilaci√≥n auricular</title>

<style>
:root{
  --bg:#f9fafc;--ink:#0e1a33;--accent:#0f3d83;
  --border:#e5e9f2;--muted:#64748b;
  --ok-bg:#dcfce7;--ok-txt:#065f46;--ok-bd:#86efac;
  --mid-bg:#fef3c7;--mid-txt:#92400e;--mid-bd:#fde68a;
  --bad-bg:#fee2e2;--bad-txt:#991b1b;--bad-bd:#fecaca;
}
:root{
  --bg:#f9fafc;
  --ink:#0e1a33;
  --accent-dark:#0f3d83;
  --accent-light:#2563eb;
  --border:#e5e9f2;
  --muted:#64748b;
  --ok:#166534; --ok-bg:#e9fce7; --ok-ring:#bbf7d0;
  --mid:#92400e; --mid-bg:#fff7ed; --mid-ring:#fed7aa;
  --bad:#991b1b; --bad-bg:#fef2f2; --bad-ring:#fecaca;
  --azul-institucional:#0f3d83;
}
*{box-sizing:border-box}

/* =========================================================
   SAFE-TOP
========================================================= */
.safe-top {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: calc(env(safe-area-inset-top, 0px) + 60px);
  background: var(--azul-institucional);
  z-index: 1001;
  display: flex;
  align-items: flex-start;
  justify-content: center;
  padding-top: env(safe-area-inset-top, 0px);
}
.safe-content {
  width: 100%;
  max-width: 1080px;
  padding: 6px 16px 8px;
  display: flex;
  justify-content: space-between;
  align-items: flex-start; 
  /* A√±adir un padding-top para empujar los iconos ligeramente hacia abajo y no pegarlos al borde */
  padding-top: 5px; /* Ajuste manual para bajar los iconos un poco */
  padding-bottom: 0; /* Eliminar padding inferior para reservar ese espacio */
}
.safe-left {
  display: flex;
  align-items: center;
  gap: 10px;
}
.safe-mini {
  width: 44px;
  height: 44px;
  object-fit: contain;
  padding: 4px;
  box-shadow: 0 0 4px rgba(0,0,0,0.1);
}
.safe-logo {
  height: 44px;
  width: auto;
}
.safe-actions {
  display: flex;
  gap: 10px;
}
.safe-btn {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 40px;
  height: 40px;
  background: rgba(255,255,255,0.15);
  border: 1px solid white;
  border-radius: 50%;
  transition: background .25s, border-color .25s, transform .1s;
}
.safe-btn:hover {
  background: #01c5fe;
  border: 1px solid white;
}
.safe-btn:active { transform: scale(0.95); }
.safe-icon {
  width: 32px;
  height: 32px;
  object-fit: contain;
}
/* CABECERA */
header{position:sticky;
  z-index:1002;background:var(--accent);color:#fff;
  box-shadow:0 2px 6px rgba(0,0,0,.08);top: calc(env(safe-area-inset-top, 0px) + 52px);
}
.bar{display:flex;justify-content:center;align-items:center;gap:10px;
  height:52px;padding:0 16px;}
.bar h1{font-size:1.4rem;font-weight:700;margin:0;}
/* =========================================================
   CABECERA
========================================================= */

.bar h1 {
  display: flex; /* <-- NUEVO: Habilita flexbox para alinear el icono */
  align-items: center; /* <-- NUEVO: Centra el icono y el texto verticalmente */
  /* ... (otras reglas de title) ... */
}
.bar h1 img {
  width: 32px; /* Define el tama√±o del icono */
  height: 32px;
  margin-right: 8px; /* Espacio entre el icono y el texto "ABCD¬≤" */
}
.pill{
  display:inline-flex; align-items:center; justify-content:center;
  min-width:38px; height:25px; padding:6px 10px;
  border-radius:999px; font-size:13px; font-weight:700;
  border:1px solid transparent; background:#dbeafe; color:#1e3a8a;
  white-space:nowrap; overflow:hidden; text-overflow:ellipsis;
}
.pill-ok{background:var(--ok-bg);color:var(--ok-txt);border-color:var(--ok-bd);}
.pill-warn{background:var(--mid-bg);color:var(--mid-txt);border-color:var(--mid-bd);}
.pill-bad{background:var(--bad-bg);color:var(--bad-txt);border-color:var(--bad-bd);}
.pill-neutral{background:#e2e8f0;color:#1e293b;border-color:#cbd5e1;}

/* INTRO */
.howto{
  background:#fff;
  border:1px solid var(--border);
  border-radius:14px;
  box-shadow:0 2px 2px var(--muted);
  padding:.5rem;
  margin:.5rem 0 1rem;
  font-size:14px;
}

/* CUERPO */
body{margin:0;background:var(--bg);color:var(--ink);font-family:Verdana,Geneva,sans-serif;
  padding-top:12px);}
.container{max-width:980px;margin:14px auto 40px;padding:2px 16px;}
.card{background:#fff;border:1px solid var(--border);border-radius:16px;
  padding:18px;box-shadow:0 2px 10px rgba(15,23,42,.06);margin-top:12px;}
label{font-weight:700;color:var(--accent);}
select{width:100%;padding:12px;border-radius:10px;border:1px solid var(--border);
  background:#fff;font-size:15px;}
select:focus{outline:none;color:var(--accent);border:1px solid;}
.note{color:var(--muted);font-size:13px;margin-bottom:10px;}

/* RESULTADOS */
.result-ok{background:var(--ok-bg);border-color:var(--ok-bd);}
.result-warn{background:var(--mid-bg);border-color:var(--mid-bd);}
.result-bad{background:var(--bad-bg);border-color:var(--bad-bd);}
.result.show{display:block;}
.score-label{font-size:15px;font-weight:700;text-align:center;}
/* === Tonalidad global de la tarjeta de resultado === */
#resultCard{
  border:1px solid var(--border);
  border-radius:16px;
  padding:16px;
  transition:background .2s, border-color .2s, color .2s;
}

/* Fondo + bordes coherentes con los tonos */
#resultCard.ok   { background: var(--ok-bg);  border-color: var(--ok-bd); }
#resultCard.warn { background: var(--mid-bg); border-color: var(--mid-bd); }
#resultCard.bad  { background: var(--bad-bg); border-color: var(--bad-bd); }

/* Texto dentro de la tarjeta en cada tono */
#resultCard.ok   .ttl, #resultCard.ok   .val { color: var(--ok-txt);  }
#resultCard.warn .ttl, #resultCard.warn .val { color: var(--mid-txt); }
#resultCard.bad  .ttl, #resultCard.bad  .val { color: var(--bad-txt); }

/* P√≠ldora ‚Äúneutra‚Äù al iniciar (guion) */
.pill-neutral{
  background:#e2e8f0; color:#1e293b; border-color:#cbd5e1;
}

/* BOTONES */
.actions{display:flex;gap:10px;flex-wrap:wrap;margin-top:16px;}
.btn-secondary{flex:1 1 48%;border:1px solid var(--accent);border-radius:10px;
  padding:12px;font-size:15px;font-weight:700;background:#fff;color:var(--accent);
  cursor:pointer;transition:all .25s ease;}
.btn-secondary:hover{background:#e6ecff;}
.btn-secondary.copiado{background:#0f3d83!important;color:#fff!important;}

/* Pie */
footer{
  width:100%;
  margin:2rem 0 0;
  padding:1.5rem 0;
  border-top:1px solid #e5e7eb;
  background:#ffffff;
  text-align:center;
  box-shadow:0 -2px 6px rgba(0,0,0,0.04);
}
footer img{max-width:320px;height:auto;opacity:.95}

/* =========================================================
   PADDING SUPERIOR DEL CONTENIDO
========================================================= */

/* Empuja el contenido real por debajo de la barra superior */
body {
  margin: 0;
  padding-top: calc(env(safe-area-inset-top, 0px) + 52px);
  background-color: #fff;
}

#resumenText{white-space:pre-wrap;font-size:13px;color:#0f172a;margin-top:10px;
  border:1px dashed var(--border);border-radius:10px;padding:10px 12px;
  background:#f8fafc;line-height:1.45;}

@media(max-width:768px){
  header{font-size:1.05rem;}
  main{padding:0.9rem 1rem;}
  body{font-size:0.96rem;}
}

</style>
</head>

<body>
<div class="safe-top">
  <div class="safe-content">
    <div class="safe-left">
      <img src="../iconos/escalasico.png" alt="Icono Escalas" class="safe-mini">
      <img src="../img/topbar.png" alt="IctusGPS" class="safe-logo">
    </div>
    <div class="safe-actions">
      <a href="javascript:history.back()" class="safe-btn"><img src="../iconos/atrastransparente.png" class="safe-icon" alt="Atr√°s"></a>
      <a href="../index.html" class="safe-btn"><img src="../iconos/hometransparente.png" class="safe-icon" alt="Inicio"></a>
    </div>
  </div>
</div>

<header>
  <div class="bar">
    <h1><img src="../iconos/chadsva.png" alt="CHA‚ÇÇDS‚ÇÇ-VA">CHA‚ÇÇDS‚ÇÇ-VA</h1>
    <output id="pill" class="pill pill-neutral">‚Äî</output>
  </div>
</header>



<main class="container">
<div class="howto">Calcula el <b>riesgo de ictus en fibrilaci√≥n auricular</b> seg√∫n la escala CHA‚ÇÇDS‚ÇÇ-VA, que valora edad, hipertensi√≥n, diabetes, insuficiencia cardiaca, enfermedad vascular e ictus/AIT previo. La puntuaci√≥n total (0‚Äì8) estima el <b>riesgo anual de ictus isqu√©mico</b> y orienta la indicaci√≥n de anticoagulaci√≥n seg√∫n las gu√≠as ESC 2024.</div>
  <div class="card">
    <form id="form">
      <div class="note">Selecciona los factores de riesgo presentes:</div>
      <div class="grid">
        <div><label for="age">Edad</label>
          <select id="age">
            <option value="0">&lt;65 a√±os (0)</option>
            <option value="1">65‚Äì74 a√±os (1)</option>
            <option value="2">‚â•75 a√±os (2)</option>
          </select></div>
        <div><label for="htn">Hipertensi√≥n</label>
          <select id="htn"><option value="0">No (0)</option><option value="1">S√≠ (1)</option></select></div>
        <div><label for="dm">Diabetes mellitus</label>
          <select id="dm"><option value="0">No (0)</option><option value="1">S√≠ (1)</option></select></div>
        <div><label for="hf">Insuficiencia cardiaca</label>
          <select id="hf"><option value="0">No (0)</option><option value="1">S√≠ (1)</option></select></div>
        <div><label for="vasc">Enfermedad vascular</label>
          <select id="vasc"><option value="0">No (0)</option><option value="1">S√≠ (1)</option></select></div>
        <div><label for="stroke">Ictus/AIT/embolia arterial previa</label>
          <select id="stroke"><option value="0">No (0)</option><option value="2">S√≠ (2)</option></select></div>
      </div>

      <div id="resultCard" class="card result" style="margin-top:16px;display:none;">
        <div class="score">
<div class="ttl" style="font-size: 1.5rem; text-align: center; text-shadow: 2px 2px 6px rgba(0,0,0,0.25);"><b>Puntuaci√≥n: <class="val" id="scoreVal">‚Äî</div>
          <div class="score-label" id="scoreLabel"></b></div>
        </div> <div id="resumenText"></div>

        <div class="actions">
          <button id="btnClear" type="button" class="btn-secondary">Borrar</button>
          <button id="btnCopy" type="button" class="btn-secondary">Copiar resumen</button>
        </div>
      </div>
    </form>
  </div>

</main>

<script>
// ====== Riesgo anual aproximado por puntuaci√≥n CHA2DS2-VA (ESC 2024) ======
const RATE = {
  0: 0.5,
  1: 1.5,
  2: 2.9,
  3: 5.1,
  4: 7.3,
  5: 11.2,
  6: 15.5,
  7: 14.7,
  8: 19.5
};

// Utilidades b√°sicas
function el(id){ return document.getElementById(id); }
function val(id){ return Number(el(id).value || 0); }
function fmtPct(x){ return String(x).replace('.', ',') + ' %'; }

// Clasificaci√≥n por puntuaci√≥n
function labelFor(score){
  if (score === 0) return 'Bajo';
  if (score === 1) return 'Intermedio';
  return 'Alto';
}

function recFor(score){
  if (score === 0) return 'No recomendar anticoagulaci√≥n';
  if (score === 1) return 'Considerar anticoagulaci√≥n seg√∫n perfil y preferencia';
  return 'Recomendar anticoagulaci√≥n si no hay contraindicaciones';
}

function toneFor(score){
  if (score === 0) return 'ok';
  if (score === 1) return 'warn';
  return 'bad';
}

// P√≠ldora de la cabecera
function setPillFromScore(score){
  var pill = el('pill');
  if (!pill) return;

  // Estado inicial/neutro
  if (isNaN(score)){
    pill.className = 'pill pill-neutral';
    pill.textContent = '‚Äî';
    return;
  }

  var tone = toneFor(score);
  pill.className = 'pill ' + (tone === 'ok'
    ? 'pill-ok'
    : tone === 'warn'
      ? 'pill-warn'
      : 'pill-bad');

  pill.textContent = score + ' ¬∑ ' + labelFor(score);
}

// C√°lculo principal
function calc(){
  var s = val('age') + val('htn') + val('dm') + val('hf') + val('vasc') + val('stroke');
  var cat  = labelFor(s);
  var tone = toneFor(s);
  var rate = RATE.hasOwnProperty(s) ? RATE[s] : '‚Äî';

  // Mostrar tarjeta de resultado
  var card = el('resultCard');
  card.style.display = 'block';
  card.classList.remove('ok','warn','bad');
  card.classList.add(tone);

  // Valores num√©ricos
  el('scoreVal').textContent   = s;
  el('scoreLabel').textContent = cat;

  // Actualizar p√≠ldora
  setPillFromScore(s);

  // Actualizar texto de resumen
  mostrarResumen(s, cat, rate);
}

// Construcci√≥n del resumen textual
function mostrarResumen(s, cat, rate){
  var res = el('resumenText');
  var pct = (rate === '‚Äî') ? '‚Äî' : fmtPct(rate);
  var texto = '';

  texto += 'CHA2DS2-VA: ' + s + ' (' + cat + ')\n';
  texto += 'Riesgo anual aproximado: ' + pct + '\n';
  texto += 'Recomendaci√≥n: ' + recFor(s) + '\n\n';
  texto += 'Detalle de variables seleccionadas:\n';

  var campos  = ['age','htn','dm','hf','vasc','stroke'];
  var nombres = [
    'Edad',
    'Hipertensi√≥n',
    'Diabetes mellitus',
    'Insuficiencia cardiaca',
    'Enfermedad vascular',
    'Ictus/AIT/embolia arterial previa'
  ];

  for (var i = 0; i < campos.length; i++){
    var sel = el(campos[i]);
    if (!sel) continue;
    var opt = sel.options[sel.selectedIndex];
    texto += '- ' + nombres[i] + ': ' + opt.textContent + '\n';
  }

  texto += '\nInterpretaci√≥n cl√≠nica: ';
  if (s === 0){
    texto += 'paciente con riesgo muy bajo de ictus; no se recomienda anticoagulaci√≥n.';
  } else if (s === 1){
    texto += 'riesgo intermedio; considerar anticoagulaci√≥n de forma individualizada.';
  } else {
    texto += 'riesgo alto de ictus; se recomienda anticoagulaci√≥n salvo contraindicaci√≥n.';
  }

  res.textContent = texto;
}

// Bot√≥n Borrar
function borrar(){
  document.getElementById('form').reset();

  var card = el('resultCard');
  card.style.display = 'none';
  card.classList.remove('ok','warn','bad');

  el('scoreVal').textContent   = '‚Äî';
  el('scoreLabel').textContent = '';
  el('resumenText').textContent = '';

  setPillFromScore(NaN);
// üîµ Scroll al inicio suavemente
  window.scrollTo({
    top: 0,
    behavior: "smooth"
  });
}

// Bot√≥n Copiar resumen
function copiar(){
  var texto = el('resumenText').textContent.trim();
  if (!texto) return;

  navigator.clipboard.writeText(texto).then(function(){
    var btn = el('btnCopy');
    btn.classList.add('copiado');
    btn.textContent = 'Copiado';
    setTimeout(function(){
      btn.classList.remove('copiado');
      btn.textContent = 'Copiar resumen';
    }, 3000);
  });
}

// Inicializaci√≥n
document.addEventListener('DOMContentLoaded', function(){
  setPillFromScore(NaN); // estado inicial

  // Recalcular al cambiar cualquier select del formulario
  var selects = document.querySelectorAll('#form select');
  for (var i = 0; i < selects.length; i++){
    selects[i].addEventListener('change', calc);
  }

  el('btnClear').addEventListener('click', borrar);
  el('btnCopy').addEventListener('click', copiar);
});
</script>



<footer>
  <img src="../img/uibanner.png" alt="Ictus GPS">
</footer>
</body>
</html>
