<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="manifest" href="../site.webmanifest">
<link rel="icon" type="image/png" sizes="192x192" href="../iconos/ictusgps.png">
<link rel="apple-touch-icon" sizes="180x180" href="../iconos/ictusgps.png">
<link rel="shortcut icon" href="../iconos/ictusgps.png">
<meta name="theme-color" content="#0f3d83">
<title>Escala Canadiense</title>

<style>
:root{
  --bg:#f9fafc;--ink:#0e1a33;--accent:#0f3d83;
  --border:#e5e9f2;--muted:#64748b;
  --ok-bg:#dcfce7;--ok-txt:#065f46;--ok-bd:#86efac;
  --mid-bg:#fef3c7;--mid-txt:#92400e;--mid-bd:#fde68a;
  --bad-bg:#fee2e2;--bad-txt:#991b1b;--bad-bd:#fecaca;
}
*{box-sizing:border-box}

/* =========================================================
   SAFE-TOP
========================================================= */
.safe-top {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: calc(env(safe-area-inset-top, 0px) + 60px);
  background: #0f3d83;
  z-index: 1001;
  display: flex;
  align-items: flex-start;
  justify-content: center;
  padding-top: env(safe-area-inset-top, 0px);
}
.safe-content {
  width: 100%;
  max-width: 1080px;
  padding: 6px 16px 8px;
  display: flex;
  justify-content: space-between;
  align-items: flex-start; 
  /* Añadir un padding-top para empujar los iconos ligeramente hacia abajo y no pegarlos al borde */
  padding-top: 5px; /* Ajuste manual para bajar los iconos un poco */
  padding-bottom: 0; /* Eliminar padding inferior para reservar ese espacio */
}
.safe-left {
  display: flex;
  align-items: center;
  gap: 10px;
}
.safe-mini {
  width: 44px;
  height: 44px;
  object-fit: contain;
  padding: 4px;
  box-shadow: 0 0 4px rgba(0,0,0,0.1);
}
.safe-logo {
  height: 44px;
  width: auto;
}
.safe-actions {
  display: flex;
  gap: 10px;
}
.safe-btn {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 40px;
  height: 40px;
  background: rgba(255,255,255,0.15);
  border: 1px solid white;
  border-radius: 50%;
  transition: background .25s, border-color .25s, transform .1s;
}
.safe-btn:hover {
  background: #01c5fe;
  border: 1px solid white;
}
.safe-btn:active { transform: scale(0.95); }
.safe-icon {
  width: 32px;
  height: 32px;
  object-fit: contain;
}
/* CABECERA */
header{position:sticky;
  z-index:1002;background:var(--accent);color:#fff;
  box-shadow:0 2px 6px rgba(0,0,0,.08);top: calc(env(safe-area-inset-top, 0px) + 52px);
}
.bar{display:flex;justify-content:center;align-items:center;gap:10px;
  height:52px;padding:0 16px;}
.bar h1{font-size:1.4rem;font-weight:700;margin:0;}
/* =========================================================
   CABECERA
========================================================= */
/* ... (reglas existentes) ... */
.bar {
  display:flex;
  justify-content:center;
  align-items:center;
  gap: 10px;
  height:52px;
  padding:4px 16px;
}

.bar h1 {
  display: flex; /* <-- NUEVO: Habilita flexbox para alinear el icono */
  align-items: center; /* <-- NUEVO: Centra el icono y el texto verticalmente */
  /* ... (otras reglas de title) ... */
}
.bar img {
  width: 32px; /* Define el tamaño del icono */
  height: 32px;
  margin-right: 8px; /* Espacio entre el icono y el texto "ABCD²" */
}
.pill{
  display:inline-flex; align-items:center; justify-content:center;
  min-width:38px; height:25px; padding:6px 10px;
  border-radius:999px; font-size:13px; font-weight:700;
  border:1px solid transparent; background:#dbeafe; color:#1e3a8a;
  white-space:nowrap; overflow:hidden; text-overflow:ellipsis;
}
.pill-ok{background:var(--ok-bg);color:var(--ok-txt);border-color:var(--ok-bd);}
.pill-warn{background:var(--mid-bg);color:var(--mid-txt);border-color:var(--mid-bd);}
.pill-bad{background:var(--bad-bg);color:var(--bad-txt);border-color:var(--bad-bd);}
.pill-neutral {
  background: #e2e8f0;
  color: #1e293b;
  border-color: #cbd5e1;
}
/* === Tarjeta de resultado coloreada === */
.result-ok {
  background: var(--ok-bg);
  border-color: var(--ok-bd);
  box-shadow: 0 2px 12px rgba(6, 95, 70, .25);
}
.result-warn {
  background: var(--mid-bg);
  border-color: var(--mid-bd);
  box-shadow: 0 2px 12px rgba(146, 64, 14, .25);
}
.result-bad {
  background: var(--bad-bg);
  border-color: var(--bad-bd);
  box-shadow: 0 2px 12px rgba(153, 27, 27, .25);
}


/* INTRO */
.intro{max-width:980px;margin-inline:auto;padding:52px 16px 0;color:var(--muted);
  font-size:.95rem;line-height:1.45;text-align:justify;}
.intro strong{color:var(--accent);}

.intro2{
  margin-inline:auto;padding:4px 0px 5px;background:dark blue;color:white;
  font-size:1.1rem;line-height:1.45;text-align:justify;}
.intro2 strong{color:var(--accent);text-shadow: 2px 2px 6px rgba(0,0,0,0.25);}

/* CUERPO */
body{padding-top:10px;}
body{margin:0;background:var(--bg);color:var(--ink);font-family:Verdana,Geneva,sans-serif;}
.container{max-width:980px;margin:14px auto 40px;padding:12px 16px;}
.card{background:#fff;border:1px solid var(--border);border-radius:16px;
  padding:18px;box-shadow:0 2px 10px rgba(15,23,42,.06);margin-top:12px;}
label{font-weight:700;color:var(--accent);}
select{width:100%;padding:12px;border-radius:10px;border:1px solid var(--border);
  background:#fff;font-size:15px;}
select:focus{outline:none;color:var(--accent);border:1px solid;}
hint{color:red;}
/* RESULTADOS */
.result{display:none;}
.result.show{display:block;}
.score{display:flex;flex-direction:column;align-items:center;
  border:1px dashed var(--border);border-radius:14px;padding:20px 16px;
  background:#fff;margin-top:8px;}
.score .ttl{font-size:15px;color:var(--muted);}
.score .val{font-size:40px;font-weight:800;color:var(--accent);}
.score-label{font-size:15px;font-weight:700;margin-top:4px;text-align:center;}
#resumenText{white-space:pre-wrap;font-size:13px;color:#0f172a;margin-top:10px;
  border:1px dashed var(--border);border-radius:10px;padding:10px 12px;
  background:#f8fafc;line-height:1.45;}

/* BOTONES */
.actions{display:flex;gap:10px;flex-wrap:wrap;margin-top:16px;}
.btn-secondary{flex:1 1 48%;border:1px solid var(--accent);border-radius:10px;
  padding:12px;font-size:15px;font-weight:700;background:#fff;color:var(--accent);
  cursor:pointer;transition:all .25s ease;}
.btn-secondary:hover{background:#e6ecff;}
.btn-secondary.copiado{background:#0f3d83!important;color:#fff!important;}
.back-btn{display:inline-block;margin:1.5rem auto 0;background:#0f3d83;color:#fff;
  text-decoration:none;font-weight:700;padding:.7rem 1.4rem;border-radius:10px;
  box-shadow:0 4px 10px rgba(15,61,131,.25);transition:background .2s,transform .1s;}
.back-btn:hover{background:#1c60c3;transform:translateY(-1px);}

/* Pie */
footer{
  width:100%;
  margin:2rem 0 0;
  padding:1.5rem 0;
  border-top:1px solid #e5e7eb;
  background:#ffffff;
  text-align:center;
  box-shadow:0 -2px 6px rgba(0,0,0,0.04);
}
footer img{max-width:320px;height:auto;opacity:.95}

</style>
</head>

<body>
<div class="safe-top">
  <div class="safe-content">
    <div class="safe-left">
      <img src="../iconos/escalasico.png" alt="Icono Escalas" class="safe-mini">
      <img src="../img/topbar.png" alt="IctusGPS" class="safe-logo">
    </div>
    <div class="safe-actions">
      <a href="javascript:history.back()" class="safe-btn"><img src="../iconos/atrastransparente.png" class="safe-icon" alt="Atrás"></a>
      <a href="../index.html" class="safe-btn"><img src="../iconos/hometransparente.png" class="safe-icon" alt="Inicio"></a>
    </div>
  </div>
</div>

<header>
  <div class="bar">
    <h1><img src="../iconos/canadiense.png" alt="Canadiense">Canadiense</h1>
    <output id="pill" class="pill">—</output>
  </div>
</header>



<main class="container">
<section class="intro">
  <p>
    Evalúa el <strong>déficit neurológico global</strong> en pacientes con ictus, considerando nivel de conciencia, orientación, lenguaje y función motora. 
    La puntuación total varía entre <strong>2 y 10</strong>; valores más altos indican mejor estado neurológico. <strong>No es aplicable a pacientes en coma.</strong>
  </p>
</section>
  <div class="card">
    <form id="form" autocomplete="off">
      <label for="conciencia">Nivel de conciencia</label>
      <select id="conciencia">
        <option value="">Selecciona…</option>
        <option value="3">Alerta</option>
        <option value="1.5">Obnubilado / somnoliento</option>
      </select>

      <label for="orientacion">Orientación</label>
      <select id="orientacion">
        <option value="">Selecciona…</option>
        <option value="1">Orientado</option>
        <option value="0">Desorientado</option>
      </select>

      <label for="lenguaje">Lenguaje</label>
      <select id="lenguaje">
        <option value="">Selecciona…</option>
        <option value="1">Normal</option>
        <option value="0.5">Déficit expresivo</option>
        <option value="0">Déficit de comprensión</option>
      </select>

      <p class="hint">Si se elige "déficit de comprensión", se evalúa con modo "no comprende".</p>

      <div id="motor1" class="card" style="padding:12px;margin-top:14px;">
        <section class="intro2"><strong>Función motora — comprende</strong></section>
        <label for="m1c">Cara</label>
        <select id="m1c"><option value="">Selecciona…</option><option value="0.5">Sin asimetrías</option><option value="0">Asimétrica</option></select>
        <label for="m1b">Brazo proximal</label>
        <select id="m1b"><option value="">Selecciona…</option><option value="1.5">No paresia</option><option value="1">Paresia leve-moderada</option><option value="0.5">Paresia importante</option><option value="0">Paresia completa</option></select>
        <label for="m1bd">Brazo distal</label>
        <select id="m1bd"><option value="">Selecciona…</option><option value="1.5">No paresia</option><option value="1">Paresia leve-moderada</option><option value="0.5">Paresia importante</option><option value="0">Paresia completa</option></select>
        <label for="m1p">Pierna</label>
        <select id="m1p"><option value="">Selecciona…</option><option value="1.5">No paresia</option><option value="1">Paresia leve-moderada</option><option value="0.5">Paresia importante</option><option value="0">Paresia completa</option></select>
      </div>

      <div id="motor2" class="card" style="padding:12px;margin-top:14px;display:none;">
        <section class="intro2"><strong>Función motora — no comprende</strong></section>
        <label for="m2c">Cara</label>
        <select id="m2c"><option value="">Selecciona…</option><option value="0.5">Sin asimetrías</option><option value="0">Asimétrica</option></select>
        <label for="m2b">Brazos</label>
        <select id="m2b"><option value="">Selecciona…</option><option value="1.5">Simétricos</option><option value="0">Asimétricos</option></select>
        <label for="m2p">Piernas</label>
        <select id="m2p"><option value="">Selecciona…</option><option value="1.5">Simétricas</option><option value="0">Asimétricas</option></select>
      </div>

      <div class="actions">
        <button id="btnBorrar" type="button" class="btn-secondary">Borrar</button>
        <button id="btnCopiar" type="button" class="btn-secondary">Copiar resumen</button>
      </div>
      <div id="err" class="err" style="display:none;color:#b91c1c;font-weight:700;margin-top:8px;"></div>
    </form>
  </div>

  <div id="resultCard" class="card result">
    <div class="score">
      <div class="ttl">Puntuación total</div>
      <div class="val" id="scoreVal">—</div>
      <div class="score-label" id="scoreLabel"></div>
    </div>
    <div id="resumenText"></div>
  </div>
</main>

<script>
function el(id){return document.getElementById(id);}
function toggleMotor(){
  const lang=el('lenguaje').value;
  const noComprende=(lang==='0');
  el('motor1').style.display=noComprende?'none':'block';
  el('motor2').style.display=noComprende?'block':'none';
}
function setPill(score){
  const pill = el('pill');
  pill.className = 'pill';
  if (isNaN(score)) {
    pill.textContent = '—';
    pill.classList.add('pill-neutral');
    return;
  }
  pill.textContent = score.toFixed(1).replace('.', ',');
  if (score >= 8) pill.classList.add('pill-ok');
  else if (score >= 5) pill.classList.add('pill-warn');
  else pill.classList.add('pill-bad');
}

function calcular(){
  const c=parseFloat(el('conciencia').value),
        o=parseFloat(el('orientacion').value),
        l=parseFloat(el('lenguaje').value);
  if(isNaN(c)||isNaN(o)||isNaN(l)){return;}
  let total=c+o+l;

  if(l===0){
    const arr=[el('m2c'),el('m2b'),el('m2p')].map(s=>parseFloat(s.value));
    if(arr.some(isNaN))return;
    total+=arr.reduce((a,b)=>a+b,0);
  }else{
    const arr=[el('m1c'),el('m1b'),el('m1bd'),el('m1p')].map(s=>parseFloat(s.value));
    if(arr.some(isNaN))return;
    total+=arr.reduce((a,b)=>a+b,0);
  }

  const resultCard = el('resultCard');
  const scoreVal = el('scoreVal');
  const scoreLabel = el('scoreLabel');

  let label='', colorClass='', txtColor='';
  if(total>=8){
    label='Déficit leve o ausente';
    colorClass='result-ok';
    txtColor= 'var(--ok-txt)';
  } else if(total>=5){
    label='Déficit moderado';
    colorClass='result-warn';
    txtColor= 'var(--mid-txt)';
  } else {
    label='Déficit grave';
    colorClass='result-bad';
    txtColor= 'var(--bad-txt)';
  }

  // Actualiza contenido y color de texto
  scoreVal.textContent = total.toFixed(1).replace('.',',');
  scoreLabel.textContent = label;
  scoreVal.style.color = txtColor;
  scoreLabel.style.color = txtColor;

  // Aplica la clase de color al contenedor
  resultCard.classList.add('show');
  resultCard.classList.remove('result-ok','result-warn','result-bad');
  resultCard.classList.add(colorClass);

  // Actualiza la pill superior
  setPill(total);
  return { total, label };
}
function borrar(){
  document.getElementById('form').reset();
  el('resultCard').classList.remove('show');
  el('scoreVal').textContent='—';
  el('scoreLabel').textContent='';
  el('resumenText').textContent='';
  setPill(NaN);
  toggleMotor();
}
function copiar(){
  const datos=calcular();
  if(!datos)return;
  const txt=`Escala Canadiense: ${datos.total.toFixed(1)} puntos (${datos.label}).`;
  el('resumenText').textContent=txt;
  navigator.clipboard.writeText(txt);
  const btn=el('btnCopiar');
  btn.classList.add('copiado');
  btn.textContent='Copiado';
  setTimeout(()=>{btn.classList.remove('copiado');btn.textContent='Copiar resumen';},3000);
}
document.addEventListener('DOMContentLoaded',()=>{
  document.querySelectorAll('select').forEach(s=>s.addEventListener('change',()=>{toggleMotor();calcular();}));
  el('btnBorrar').addEventListener('click',borrar);
  el('btnCopiar').addEventListener('click',copiar);
  setPill(NaN);
});
</script>

<footer>
  <img src="../img/uibanner.png" alt="Ictus GPS">
</footer>
</body>
</html>
