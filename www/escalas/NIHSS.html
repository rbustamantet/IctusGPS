<!DOCTYPE html>
<html lang="es">
  <head>

    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="manifest" href="../site.webmanifest">
    <link rel="icon" type="image/png" sizes="192x192"
      href="../iconos/ictusgps.png">
    <link rel="apple-touch-icon" sizes="180x180"
      href="../iconos/ictusgps.png">
    <link rel="shortcut icon" href="../iconos/ictusgps.png">
    <meta name="theme-color" content="#0f3d83">
    <title>Escala del NIH para el Ictus (NIHSS)</title>
    <style>
:root{
  --bg:#f8fafc; --ink:#0f172a; --borde:#e5e7eb; --borde2:#dbeafe;
  --accent:#2563eb; --accent-ink:#1e3a8a; --accent-dark:#0f3d83;
  --accent-light:#eaf2ff;
  --brand:#0f3d83;
  --border:#e5e9f2;
  --muted:#64748b;
  --azul-institucional:#0f3d83;
  --ok:#166534; --ok-bg:#e9fce7; --ok-ring:#bbf7d0;
  --mid:#92400e; --mid-bg:#fff7ed; --mid-ring:#fed7aa;
  --bad:#991b1b; --bad-bg:#fef2f2; --bad-ring:#fecaca;
}
*{box-sizing:border-box}

/* =========================================================
   SAFE-TOP
========================================================= */
.safe-top {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: calc(env(safe-area-inset-top, 0px) + 60px);
  background: var(--azul-institucional);
  z-index: 1001;
  display: flex;
  align-items: flex-start;
  justify-content: center;
  padding-top: env(safe-area-inset-top, 0px);
}
.safe-content {
  width: 100%;
  max-width: 1080px;
  padding: 6px 16px 8px;
  display: flex;
  justify-content: space-between;
  align-items: flex-start; 
  /* A√±adir un padding-top para empujar los iconos ligeramente hacia abajo y no pegarlos al borde */
  padding-top: 5px; /* Ajuste manual para bajar los iconos un poco */
  padding-bottom: 0; /* Eliminar padding inferior para reservar ese espacio */
}
.safe-left {
  display: flex;
  align-items: center;
  gap: 10px;
}
.safe-mini {
  width: 44px;
  height: 44px;
  object-fit: contain;
  padding: 4px;
  box-shadow: 0 0 4px rgba(0,0,0,0.1);
}
.safe-logo {
  height: 44px;
  width: auto;
}
.safe-actions {
  display: flex;
  gap: 10px;
}
.safe-btn {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 40px;
  height: 40px;
  background: rgba(255,255,255,0.15);
  border: 1px solid white;
  border-radius: 50%;
  transition: background .25s, border-color .25s, transform .1s;
}
.safe-btn:hover {
  background: #01c5fe;
  border: 1px solid white;
}
.safe-btn:active { transform: scale(0.95); }
.safe-icon {
  width: 32px;
  height: 32px;
  object-fit: contain;
}
/* =========================================================
   CABECERA INFERIOR (STICKY)
========================================================= */
header {
  position: sticky;
  top: calc(env(safe-area-inset-top, 0px) + 52px);
  z-index: 1002;
  backdrop-filter: blur(6px);
  background: var(--accent-dark);
  border-bottom: 1px solid rgba(255,255,255,.08);
  box-shadow: 0 2px 6px rgba(0,0,0,0.08);
  color: #fff;
}
.bar {
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 10px;
  height: 52px;
  padding: 0 16px;
}
.title {
  font-size: 1.4rem;
  font-weight: 700;
  color: #fff;
  display: flex; /* <-- NUEVO: Habilita flexbox para alinear el icono */
  align-items: center; /* <-- NUEVO: Centra el icono y el texto verticalmente */
}

.title img {
  width: 32px; /* Define el tama√±o del icono */
  height: 32px;
  margin-right: 8px; /* Espacio entre el icono y el texto "ABCD¬≤" */
}
/* Pill junto al t√≠tulo */
.pill{
  display:inline-flex; align-items:center; justify-content:center;
  min-width:38px; height:25px; padding:6px 10px;
  border-radius:999px; font-size:13px; font-weight:700;
  border:1px solid transparent; background:#dbeafe; color:#1e3a8a;
  white-space:nowrap; overflow:hidden; text-overflow:ellipsis;
}
.pill.ok   { background:#dcfce7; color:#065f46; border-color:#86efac; }
.pill.warn { background:#fef3c7; color:#92400e; border-color:#fde68a; }
.pill.bad  { background:#fee2e2; color:#991b1b; border-color:#fecaca; }

/* INTRO */
.howto{
  background:#fff;
  border:1px solid var(--border);
  border-radius:14px;
  box-shadow:0 2px 2px var(--muted);
  padding:.5rem;
  margin:.5rem 0 1rem;
  font-size:14px;
}

/* ===== CUERPO ===== */
body{margin:0;background:var(--bg);color:var(--ink);font-family:Verdana, Geneva, sans-serif;}
.wrap{max-width:980px;margin:16px auto 48px;padding:2px 16px;}
.panel{background:#fff;border:1px solid var(--borde);border-radius:16px;padding:16px;box-shadow:0 2px 10px rgba(15,23,42,.06);}
.note{color:#64748b;font-size:12px;margin:.25rem 0 1rem}

/* ===== BLOQUES COLAPSABLES ===== */
.coll{
  border:1px solid var(--borde2);
  border-radius:12px; overflow:hidden; background:#fff; margin-bottom:10px;
}
.coll-head{
  display:flex; align-items:center; gap:10px;
  background:var(--accent-light); color:#1e3a8a;
  padding:10px 12px; cursor:pointer; user-select:none;
  border-bottom:1px solid #cfe0ff;
}
.coll-head .arrow{
  font-weight:900; width:1.25rem; text-align:center; flex:0 0 auto;
}
.coll-head .ttl{ font-weight:900; flex:1 1 auto; }
.coll-head .help{ 
  border:none; background:#fff; color:#1e40af;
  border:1px solid #cfe0ff; border-radius:8px; padding:4px 8px; font-weight:700; font-size:12px; cursor:pointer;
}
.coll-body{ padding:12px; display:none; background:#fff; }
.coll.open .coll-body{ display:block; }
label{font-weight:900;color:#0b1f44;margin:0 0 6px;display:block;}
select{
  width:100%;padding:10px 12px;border:1px solid #cbd5e1;border-radius:10px;background:#fff;font-size:14px;
}
select:focus{outline:none;box-shadow:0 0 0 3px #dbeafe;}

/* Abiertos en escritorio, cerrados en m√≥vil */
@media (min-width: 720px){
  .coll.default-open .coll-body{ display:block; }
}

/* ===== RESULTADOS ===== */
.card{
  margin-top:12px;background:#fff;border:1px solid var(--borde);
  border-radius:16px;padding:14px;box-shadow:0 8px 22px rgba(31,86,179,.07)
}
.chips{display:flex;gap:8px;flex-wrap:wrap;margin:2px 0 10px}
.chip{font-size:13px;border:1px solid var(--borde);background:#eef6ff;color:#1e3a8a;border-radius:999px;padding:6px 10px;font-weight:700}

.kpi{display:grid;grid-template-columns:repeat(2,1fr);gap:10px}
.box{border:1.5px dashed #c7dbff;border-radius:14px;padding:12px;background:#f8fbff;text-align:center}
.ttl{font-size:15px;color:#334155;font-weight:800;margin-bottom:2px}
.val{font-size:26px;font-weight:900;color:#0b2c5f}

.okbox{background:var(--ok-bg);border-color:var(--ok-ring);}
.warnbox{background:var(--mid-bg);border-color:var(--mid-ring);}
.badbox{background:var(--bad-bg);border-color:var(--bad-ring);}
.okbox .val{color:var(--ok);} .warnbox .val{color:var(--mid);} .badbox .val{color:var(--bad);}

/* ===== BOTONES DE ACCI√ìN (igual estilo CHADS-VA) ===== */
.actions{display:flex;gap:10px;flex-wrap:wrap;margin-top:18px;}
.btn-action{
  flex:1 1 48%;
  border:none;border-radius:10px;padding:12px;
  font-size:15px;font-weight:700;cursor:pointer;transition:background .2s,color .2s,border-color .2s;
}
.btn-clear { background:#fff; color:#0b2c5f; border:1px solid #2563eb; }
.btn-clear:hover { background:#eff6ff; }
.btn-copy  { background:#fff; color:#0f3d83; border:1px solid #2563eb; }
.btn-copy:hover { background:#eff6ff; }
.btn-copy.copiado{background:#0f3d83!important;color:#fff!important;}

/* ===== RESUMEN ===== */
#resumenText{
  white-space:pre-wrap;font-size:13px;color:#0f172a;margin-top:12px;
  border:1px dashed var(--borde);border-radius:10px;padding:10px 12px;
  background:#f9fafc;line-height:1.45;
}

/* ===== MODAL DE AYUDA ===== */
.modal{
  position:fixed; inset:0; display:none;
  align-items:center; justify-content:center;
  background:rgba(15,23,42,.55);
  backdrop-filter: blur(3px);
  -webkit-backdrop-filter: blur(3px);
  padding:16px; z-index:9999;
}
.modal.open{ display:flex; }
.modal-card{
  background:#fff; border-radius:16px; border:1px solid var(--borde);
  max-width:780px; width:100%; max-height:80vh; overflow:auto;
  box-shadow:0 12px 30px rgba(0,0,0,.18);
}
.modal-head{
  display:flex; justify-content:space-between; align-items:center;
  padding:12px 16px; border-bottom:1px solid #e2e8f0;
}
.modal-title{ font-weight:800; color:#0f172a; }
.modal-body{ padding:14px 16px; color:#334155; font-size:14px; line-height:1.5; }
.modal-close{ background:transparent; border:none; color:#334155; font-weight:700; font-size:20px; cursor:pointer; }

/* Pie */
footer{
  width:100%;
  margin:2rem 0 0;
  padding:1.5rem 0;
  border-top:1px solid #e5e7eb;
  background:#ffffff;
  text-align:center;
  box-shadow:0 -2px 6px rgba(0,0,0,0.04);
}
footer img{max-width:320px;height:auto;opacity:.95}

/* =========================================================
   PADDING SUPERIOR DEL CONTENIDO
========================================================= */

/* Empuja el contenido real por debajo de la barra superior */
body {
  margin: 0;
  padding-top: calc(env(safe-area-inset-top, 0px) + 52px);
}

@media(max-width:768px){
  header{font-size:1.05rem;}
  main{padding:0.9rem 1rem;}
  body{font-size:0.96rem;}
}

</style>
  </head>
  <body>
    <!-- SAFE-TOP -->
    <div class="safe-top">
      <div class="safe-content">
        <div class="safe-left"> <img src="../iconos/escalasico.png"
            alt="Icono Escalas" class="safe-mini"> <img
            src="../img/topbar.png" alt="IctusGPS" class="safe-logo"> </div>
        <div class="safe-actions"> <a href="javascript:history.back()"
            class="safe-btn" title="Volver atr√°s"> <img
              src="../iconos/atrastransparente.png" alt="Atr√°s"
              class="safe-icon"> </a> <a href="../index.html"
            class="safe-btn" title="Volver al inicio"> <img
              src="../iconos/hometransparente.png" alt="Inicio"
              class="safe-icon"> </a> </div>
      </div>
    </div>
    <header>
      <div class="bar">
        <div class="title"><img src="../iconos/nihss.png" alt="NIHSS">NIHSS</div>
        <output id="pill" class="pill" aria-live="polite"
          aria-atomic="true">‚Äì</output> </div>
    </header>
    <main class="wrap">
      <div class="howto" align="justify">La escala NIHSS (National
        Institutes of Health Stroke Scale) es la herramienta m√°s
        utilizada para cuantificar el <b>d√©ficit neurol√≥gico</b>
        causado por un ictus isqu√©mico o hemorr√°gico. Eval√∫a 15 √≠tems
        (conciencia, lenguaje, funci√≥n motora, sensibilidad, ataxia) en
        una puntuaci√≥n de 0 a 42. Su resultado es crucial para
        determinar la <b>elegibilidad para tratamientos de reperfusi√≥n</b>
        (fibrinolisis/trombectom√≠a) y para monitorizar la <b>evoluci√≥n
          cl√≠nica</b> del paciente.</div>
      <section class="panel">
        <p class="note">Complete los √≠tems; la puntuaci√≥n total y la
          interpretaci√≥n se actualizan autom√°ticamente.</p>
        <!-- ===== BLOQUES NIHSS ===== -->
        <div id="formBlocks">
          <!-- Generaci√≥n manual para control fino de etiquetas y ayudas -->
          <!-- 1a -->
          <div class="coll default-open" data-id="n1a">
            <div class="coll-head" tabindex="0"> <span class="arrow"
                aria-hidden="true">‚ñ∏</span> <span class="ttl"><strong>1a.
                  Nivel de conciencia</strong></span> <button
                class="help" type="button" data-help="n1a">Ayuda</button>
            </div>
            <div class="coll-body"> <label for="n1a">Seleccione una
                opci√≥n</label>
              <select id="n1a">
                <option value="0" selected="selected">0 - Alerta</option>
                <option value="1">1 - Somnoliento</option>
                <option value="2">2 - Estupor</option>
                <option value="3">3 - Coma</option>
              </select>
            </div>
          </div>
          <!-- 1b -->
          <div class="coll default-open" data-id="n1b">
            <div class="coll-head" tabindex="0"> <span class="arrow"
                aria-hidden="true">‚ñ∏</span> <span class="ttl"><strong>1b.
                  Preguntas LOC</strong></span> <button class="help"
                type="button" data-help="n1b">Ayuda</button> </div>
            <div class="coll-body"> <label for="n1b">Seleccione una
                opci√≥n</label>
              <select id="n1b">
                <option value="0" selected="selected">0 - Ambas
                  respuestas correctas</option>
                <option value="1">1 - Una respuesta correcta</option>
                <option value="2">2 - Ninguna respuesta correcta</option>
              </select>
            </div>
          </div>
          <!-- 1c -->
          <div class="coll default-open" data-id="n1c">
            <div class="coll-head" tabindex="0"> <span class="arrow"
                aria-hidden="true">‚ñ∏</span> <span class="ttl"><strong>1c.
                  Comandos LOC</strong></span> <button class="help"
                type="button" data-help="n1c">Ayuda</button> </div>
            <div class="coll-body"> <label for="n1c">Seleccione una
                opci√≥n</label>
              <select id="n1c">
                <option value="0" selected="selected">0 - Cumple ambas
                  √≥rdenes</option>
                <option value="1">1 - Cumple una orden</option>
                <option value="2">2 - No cumple √≥rdenes</option>
              </select>
            </div>
          </div>
          <!-- 2 Mirada -->
          <div class="coll default-open" data-id="n2">
            <div class="coll-head" tabindex="0"> <span class="arrow"
                aria-hidden="true">‚ñ∏</span> <span class="ttl"><strong>2.
                  Mirada</strong></span> <button class="help"
                type="button" data-help="n2">Ayuda</button> </div>
            <div class="coll-body"> <label for="n2">Seleccione una
                opci√≥n</label>
              <select id="n2">
                <option value="0" selected="selected">0 - Normal</option>
                <option value="1">1 - Par√°lisis parcial de la mirada</option>
                <option value="2">2 - Par√°lisis completa o desviaci√≥n
                  forzada</option>
              </select>
            </div>
          </div>
          <!-- 3 Campos visuales -->
          <div class="coll default-open" data-id="n3">
            <div class="coll-head" tabindex="0"> <span class="arrow"
                aria-hidden="true">‚ñ∏</span> <span class="ttl"><strong>3.
                  Campos visuales</strong></span> <button class="help"
                type="button" data-help="n3">Ayuda</button> </div>
            <div class="coll-body"> <label for="n3">Seleccione una
                opci√≥n</label>
              <select id="n3">
                <option value="0" selected="selected">0 - Normal</option>
                <option value="1">1 - Defecto parcial o cuadrantanopsia</option>
                <option value="2">2 - Hemianopsia completa</option>
                <option value="3">3 - Ceguera, hemianopsia bilateral</option>
              </select>
            </div>
          </div>
          <!-- 4 Par√°lisis facial -->
          <div class="coll default-open" data-id="n4">
            <div class="coll-head" tabindex="0"> <span class="arrow"
                aria-hidden="true">‚ñ∏</span> <span class="ttl"><strong>4.
                  Par√°lisis facial</strong></span> <button class="help"
                type="button" data-help="n4">Ayuda</button> </div>
            <div class="coll-body"> <label for="n4">Seleccione una
                opci√≥n</label>
              <select id="n4">
                <option value="0" selected="selected">0 - Normal</option>
                <option value="1">1 - Paresia leve, asimetr√≠a de la
                  sonrisa</option>
                <option value="2">2 - Paresia parcial</option>
                <option value="3">3 - Par√°lisis completa</option>
              </select>
            </div>
          </div>
          <!-- 5a/b Motor brazos -->
          <div class="coll default-open" data-id="n5a">
            <div class="coll-head" tabindex="0"> <span class="arrow"
                aria-hidden="true">‚ñ∏</span> <span class="ttl"><strong>5a.
                  Motor brazo izquierdo</strong></span> <button
                class="help" type="button" data-help="n5">Ayuda</button>
            </div>
            <div class="coll-body"> <label for="n5a">Seleccione una
                opci√≥n</label>
              <select id="n5a">
                <option value="0" selected="selected">0 - No cae</option>
                <option value="1">1 - Cae antes de 10 segundos sin tocar
                  plano</option>
                <option value="2">2 - Alg√∫n esfuerzo contra la gravedad</option>
                <option value="3">3 - Sin esfuerzo contra la gravedad</option>
                <option value="4">4 - Sin movimiento</option>
                <option value="0" data-un="1">UN - No evaluable
                  (amputaci√≥n o articulaci√≥n fijada)</option>
              </select>
            </div>
          </div>
          <div class="coll default-open" data-id="n5b">
            <div class="coll-head" tabindex="0"> <span class="arrow"
                aria-hidden="true">‚ñ∏</span> <span class="ttl"><strong>5b.
                  Motor brazo derecho</strong></span> <button
                class="help" type="button" data-help="n5">Ayuda</button>
            </div>
            <div class="coll-body"> <label for="n5b">Seleccione una
                opci√≥n</label>
              <select id="n5b">
                <option value="0" selected="selected">0 - No cae</option>
                <option value="1">1 - Cae antes de 10 segundos sin tocar
                  plano</option>
                <option value="2">2 - Alg√∫n esfuerzo contra la gravedad</option>
                <option value="3">3 - Sin esfuerzo contra la gravedad</option>
                <option value="4">4 - Sin movimiento</option>
                <option value="0" data-un="1">UN - No evaluable
                  (amputaci√≥n o articulaci√≥n fijada)</option>
              </select>
            </div>
          </div>
          <!-- 6a/b Motor piernas -->
          <div class="coll default-open" data-id="n6a">
            <div class="coll-head" tabindex="0"> <span class="arrow"
                aria-hidden="true">‚ñ∏</span> <span class="ttl"><strong>6a.
                  Motor pierna izquierda</strong></span> <button
                class="help" type="button" data-help="n6">Ayuda</button>
            </div>
            <div class="coll-body"> <label for="n6a">Seleccione una
                opci√≥n</label>
              <select id="n6a">
                <option value="0" selected="selected">0 - No cae</option>
                <option value="1">1 - Cae antes de 5 segundos sin tocar
                  plano</option>
                <option value="2">2 - Alg√∫n esfuerzo contra la gravedad</option>
                <option value="3">3 - Sin esfuerzo contra la gravedad</option>
                <option value="4">4 - Sin movimiento</option>
                <option value="0" data-un="1">UN - No evaluable
                  (amputaci√≥n o articulaci√≥n fijada)</option>
              </select>
            </div>
          </div>
          <div class="coll default-open" data-id="n6b">
            <div class="coll-head" tabindex="0"> <span class="arrow"
                aria-hidden="true">‚ñ∏</span> <span class="ttl"><strong>6b.
                  Motor pierna derecha</strong></span> <button
                class="help" type="button" data-help="n6">Ayuda</button>
            </div>
            <div class="coll-body"> <label for="n6b">Seleccione una
                opci√≥n</label>
              <select id="n6b">
                <option value="0" selected="selected">0 - No cae</option>
                <option value="1">1 - Cae antes de 5 segundos sin tocar
                  plano</option>
                <option value="2">2 - Alg√∫n esfuerzo contra la gravedad</option>
                <option value="3">3 - Sin esfuerzo contra la gravedad</option>
                <option value="4">4 - Sin movimiento</option>
                <option value="0" data-un="1">UN - No evaluable
                  (amputaci√≥n o articulaci√≥n fijada)</option>
              </select>
            </div>
          </div>
          <!-- 7 Ataxia -->
          <div class="coll default-open" data-id="n7">
            <div class="coll-head" tabindex="0"> <span class="arrow"
                aria-hidden="true">‚ñ∏</span> <span class="ttl"><strong>7.
                  Ataxia</strong></span> <button class="help"
                type="button" data-help="n7">Ayuda</button> </div>
            <div class="coll-body"> <label for="n7">Seleccione una
                opci√≥n</label>
              <select id="n7">
                <option value="0" selected="selected">0 - Ausente,
                  plejia, defecto de comprensi√≥n</option>
                <option value="1">1 - En una extremidad</option>
                <option value="2">2 - En dos extremidades</option>
                <option value="0" data-un="1">UN - No evaluable
                  (amputaci√≥n o articulaci√≥n fijada)</option>
              </select>
            </div>
          </div>
          <!-- 8 Sensibilidad -->
          <div class="coll default-open" data-id="n8">
            <div class="coll-head" tabindex="0"> <span class="arrow"
                aria-hidden="true">‚ñ∏</span> <span class="ttl"><strong>8.
                  Sensibilidad</strong></span> <button class="help"
                type="button" data-help="n8">Ayuda</button> </div>
            <div class="coll-body"> <label for="n8">Seleccione una
                opci√≥n</label>
              <select id="n8">
                <option value="0" selected="selected">0 - Normal</option>
                <option value="1">1 - Leve o moderada, afasia, estupor</option>
                <option value="2">2 - Severa, bilateral o anestesia,
                  coma</option>
              </select>
            </div>
          </div>
          <!-- 9 Lenguaje -->
          <div class="coll default-open" data-id="n9">
            <div class="coll-head" tabindex="0"> <span class="arrow"
                aria-hidden="true">‚ñ∏</span> <span class="ttl"><strong>9.
                  Lenguaje</strong></span> <button class="help"
                type="button" data-help="n9">Ayuda</button> </div>
            <div class="coll-body"> <label for="n9">Seleccione una
                opci√≥n</label>
              <select id="n9">
                <option value="0" selected="selected">0 - Normal</option>
                <option value="1">1 - Afasia leve o moderada</option>
                <option value="2">2 - Afasia severa (Broca, Wernicke)</option>
                <option value="3">3 - Mutismo, afasia global, coma</option>
              </select>
            </div>
          </div>
          <!-- 10 Disartria -->
          <div class="coll default-open" data-id="n10">
            <div class="coll-head" tabindex="0"> <span class="arrow"
                aria-hidden="true">‚ñ∏</span> <span class="ttl"><strong>10.
                  Disartria</strong></span> <button class="help"
                type="button" data-help="n10">Ayuda</button> </div>
            <div class="coll-body"> <label for="n10">Seleccione una
                opci√≥n</label>
              <select id="n10">
                <option value="0" selected="selected">0 - Normal</option>
                <option value="1">1 - Leve o moderada</option>
                <option value="2">2 - Severa, ininteligible, mutismo</option>
              </select>
            </div>
          </div>
          <!-- 11 Negligencia -->
          <div class="coll default-open" data-id="n11">
            <div class="coll-head" tabindex="0"> <span class="arrow"
                aria-hidden="true">‚ñ∏</span> <span class="ttl"><strong>11.
                  Extinci√≥n o negligencia</strong></span> <button
                class="help" type="button" data-help="n11">Ayuda</button>
            </div>
            <div class="coll-body"> <label for="n11">Seleccione una
                opci√≥n</label>
              <select id="n11">
                <option value="0" selected="selected">0 - Ausente</option>
                <option value="1">1 - Solo una modalidad: visual,
                  t√°ctil, espacial, corporal</option>
                <option value="2">2 - Severa, m√°s de una modalidad</option>
              </select>
            </div>
          </div>
        </div>
        <!-- COMENTARIOS -->
        <div class="card" id="comentariosCard" style="margin-top:18px;">
          <label for="comentarios"
            style="font-weight:900;color:#0b1f44;display:block;margin-bottom:6px;">
            Comentarios </label> <textarea id="comentarios" placeholder="A√±ada observaciones o detalles cl√≠nicos..." style="width:95%;min-height:80px;resize:vertical;font-size:14px;font-family:Verdana, sans-serif;
           border:1px solid var(--borde);border-radius:10px;padding:10px 12px;line-height:1.45;
           background:#f9fafc;color:#0f172a;"></textarea>
        </div>
        <!-- ACCIONES -->
        <div class="actions"> <button id="btnClear" class="btn-action
            btn-clear" type="button">Borrar</button> <button
            id="btnCopy" class="btn-action btn-copy" type="button">Copiar
            resumen</button> </div>
        <!-- RESULTADOS -->
        <div id="resultCard" class="card">
          <div class="kpi">
            <div class="box" id="scoreBox">
              <div class="ttl">NIHSS total</div>
              <div class="val" id="scoreVal">0</div>
            </div>
            <div class="box" id="defBox">
              <div class="ttl">D√©ficit</div>
              <div class="val" id="sevVal">sin d√©ficit</div>
            </div>
          </div>
          <div class="chips" id="chips"></div>
          <p class="note">Rangos orientativos: 0 = sin d√©ficit ‚Ä¢ 1‚Äì4
            leve ‚Ä¢ 5‚Äì15 moderado ‚Ä¢ 16‚Äì20 moderado-grave ‚Ä¢ ‚â•21 grave.</p>
          <div id="resumenText" aria-label="Resumen para copiar"></div>
        </div>
      </section>
    </main>
    <!-- MODAL DE AYUDA -->
    <div class="modal" id="modal" role="dialog" aria-modal="true">
      <div class="modal-card">
        <div class="modal-head">
          <div class="modal-title" id="modal-title">Ayuda</div>
          <button class="modal-close" id="modal-close"
            aria-label="Cerrar">√ó</button> </div>
        <div class="modal-body" id="modal-body">‚Äî</div>
      </div>
    </div>
    <script>
/* ===== Utiles ===== */
const MDASH = String.fromCharCode(8212);
const campos = ['n1a','n1b','n1c','n2','n3','n4','n5a','n5b','n6a','n6b','n7','n8','n9','n10','n11'];

function gradoNIHSS(total){
  if(total===0) return 'sin d√©ficit';
  if(total<=4)  return 'leve';
  if(total<=15) return 'moderado';
  if(total<=20) return 'moderado-grave';
  return 'grave';
}
function tone(total){
  if(total<=4) return {pill:'ok', box:'okbox'};
  if(total<=20) return {pill:'warn', box:'warnbox'};
  return {pill:'bad', box:'badbox'};
}
function val(id){ return Number(document.getElementById(id).value||0); }

/* ===== Colapsables ===== */
function toggleColl(el){
  el.classList.toggle('open');
  const arrow = el.querySelector('.arrow');
  if(arrow) arrow.textContent = el.classList.contains('open') ? '‚ñæ' : '‚ñ∏';
}
document.querySelectorAll('.coll').forEach(c=>{
  const head = c.querySelector('.coll-head');
  const mq = window.matchMedia('(min-width: 720px)');
  // Cerrados en m√≥vil, abiertos en escritorio (default-open)
  if(mq.matches && c.classList.contains('default-open')) {
    c.classList.add('open');
    const a=c.querySelector('.arrow'); if(a) a.textContent='‚ñæ';
  }
  head.addEventListener('click', ()=>toggleColl(c));
  head.addEventListener('keydown', (e)=>{ if(e.key==='Enter' || e.key===' ') { e.preventDefault(); toggleColl(c);} });
});

/* ===== C√°lculo ===== */
function actualizar(){
  let total = 0;
  campos.forEach(id => total += val(id));
  const sev = gradoNIHSS(total);
  const t   = tone(total);

  // KPIs
  document.getElementById('scoreVal').textContent = total;
  document.getElementById('sevVal').textContent   = sev;
  ['scoreBox','defBox'].forEach(id=>{
    const box = document.getElementById(id);
    box.classList.remove('okbox','warnbox','badbox');
    box.classList.add(t.box);
  });

  // Pill en cabecera
  const pill = document.getElementById('pill');
  pill.className = 'pill ' + t.pill;
  pill.textContent = `${total} - ${sev}`;

  // Chips
  const chips = document.getElementById('chips');
  chips.innerHTML = '';
  chips.insertAdjacentHTML('beforeend', `<span class="chip">Escala 0‚Äì42</span>`);
  chips.insertAdjacentHTML('beforeend', `<span class="chip">Rango: ${sev}</span>`);

  // Resumen
  document.getElementById('resumenText').textContent = buildResumen(total, sev);
}

function labelTextFor(id){
  const c = document.querySelector(`.coll[data-id="${id}"] .ttl`);
  if (!c) return id;

  // Limpiar saltos de l√≠nea, tabuladores y espacios dobles
  let txt = c.textContent
      .replace(/\s+/g, ' ')   // sustituye m√∫ltiples espacios/saltos por uno
      .trim();

}

function optionTextFor(id){
  const el = document.getElementById(id);
  const opt = el.options[el.selectedIndex];
  return opt ? opt.text : '';
}
function buildResumen(total, sev){
  const lineas = campos.map(id => `- ${labelTextFor(id)}: ${optionTextFor(id)}`);
  lineas.push('--------------');
  lineas.push(`NIHSS total: ${total} (${sev})`);

  // A√±adir comentarios si existen
  const comentarios = document.getElementById('comentarios')?.value.trim();
  if (comentarios) {
    lineas.push('--------------');
    lineas.push('Comentarios:');
    lineas.push(comentarios);
  }

  return `Exploraci√≥n neurol√≥gica (NIHSS)\n` + lineas.join('\n');
}


/* ===== Acciones ===== */
document.querySelectorAll('select').forEach(s=>{
  s.addEventListener('change', actualizar);
  s.addEventListener('input', actualizar);
});

// Listener del textarea bien colocado fuera
document.getElementById('comentarios')
  .addEventListener('input', actualizar);

document.getElementById('btnClear').addEventListener('click', ()=>{
  document.querySelectorAll('select').forEach(s=> s.selectedIndex = 0);
  document.getElementById('comentarios').value = '';

  actualizar();
// üîµ Scroll al inicio suavemente
  window.scrollTo({
    top: 0,
    behavior: "smooth"
  });
});

document.getElementById('btnCopy').addEventListener('click', ()=>{
  const t = document.getElementById('resumenText').textContent.trim();
  if(!t) return;
  navigator.clipboard.writeText(t).then(()=>{
    const b = document.getElementById('btnCopy');
    b.classList.add('copiado'); b.textContent='Copiado';
    setTimeout(()=>{ b.classList.remove('copiado'); b.textContent='Copiar resumen'; }, 2500);
  });
});

/* ===== Modal de ayuda ===== */
const helpTexts = {
  n1a:`<p>Este √≠tem valora el nivel general de alerta. El examinador debe determinar si el paciente est√° despierto, orientado al entorno o si requiere est√≠mulos verbales o f√≠sicos para mantener la atenci√≥n. La somnolencia implica necesidad de estimulaci√≥n repetida; el estupor requiere est√≠mulos vigorosos para cualquier respuesta. El coma se punt√∫a cuando no hay movimientos voluntarios ni respuestas organizadas, solo reflejas o ausencia total de respuesta.</p>
`,
  n1b:`<p>Eval√∫a orientaci√≥n mediante dos preguntas sencillas cuyos resultados deben ser exactos. Si el paciente no puede hablar por barrera mec√°nica debe intentarse comunicaci√≥n alternativa; si no es posible se punt√∫a seg√∫n cooperaci√≥n observable. En afasia o estupor se asigna la puntuaci√≥n m√°xima. No se repiten las preguntas ni se aceptan aproximaciones.</p>
`,
  n1c:`<p>Valora la comprensi√≥n y ejecuci√≥n de dos √≥rdenes motoras simples. La ejecuci√≥n debe ser inmediata y clara; se acepta intento inequ√≠voco aunque incompleto. Si no comprende, puede demostrarse una vez la acci√≥n. La puntuaci√≥n se basa siempre en el primer intento. Deben considerarse afasia, d√©ficit motores o atenci√≥n fluctuante.</p>
`,
  n2:`<p>Eval√∫a los movimientos conjugados horizontales, tanto voluntarios como reflejos. La desviaci√≥n parcial o superable se punt√∫a como leve. La desviaci√≥n forzada persistente o la par√°lisis completa no superable se consideran graves. Deben descartarse alteraciones oftalmol√≥gicas o mec√°nicas previas.</p>
`,
  n3:`<p>Valora los campos visuales por confrontaci√≥n. Los defectos parciales como cuadrantanopsias punt√∫an leve; la hemianopsia completa se considera moderada; la ceguera o hemianopsia bilateral se punt√∫a como severa. Si el nivel de conciencia impide colaboraci√≥n, se asigna el mayor d√©ficit atribuible al ictus.</p>
`,
  n4:`<p>Eval√∫a la simetr√≠a facial en reposo y durante movimientos voluntarios como mostrar dientes, elevar cejas o cerrar los ojos con fuerza. Si el paciente no comprende, puede valorarse la respuesta ante est√≠mulos. Las asimetr√≠as leves punt√∫an 1, la paresia evidente en varias √°reas 2 y la ausencia completa de movimiento facial 3. Se deben considerar obst√°culos f√≠sicos como vendajes o edema.</p>
`,
  n5:`<p>Cada brazo se eval√∫a por separado elev√°ndolo a 90¬∞ sentado o 45¬∞ en dec√∫bito. Se observa si mantiene la posici√≥n durante 10 segundos. La ca√≠da lenta controlada se punt√∫a 1, el esfuerzo insuficiente contra gravedad 2, la incapacidad para superar gravedad 3 y la ausencia completa de movimiento 4. Amputaci√≥n o articulaci√≥n fijada se registran como UN. En afasia se utilizan est√≠mulos no dolorosos y tono alentador.</p>
`,
  n6:`<p>Cada pierna se eval√∫a elev√°ndola a 30¬∞ en dec√∫bito. Se registra si cae antes de 5 segundos. Los criterios de esfuerzo, gravedad y ausencia de movimiento son equivalentes a los del brazo. Amputaciones o fusiones articulares se registran como UN. Evitar est√≠mulos dolorosos salvo necesidad estricta.</p>
`,
  n7:`<p>Eval√∫a coordinaci√≥n cerebelosa mediante dedo-nariz y tal√≥n-espinilla. La ataxia debe ser atribuible al ictus y no a debilidad, dolor o d√©ficit sensorial. La afectaci√≥n en una extremidad se punt√∫a 1 y en dos extremidades 2. Si hay plejia, amputaci√≥n o imposibilidad no atribuible a la coordinaci√≥n, se registra UN.</p>
`,
  n8:`<p>Valora percepci√≥n sensitiva mediante pinchazo comparado entre ambos lados. La disminuci√≥n leve o moderada se punt√∫a 1, la p√©rdida grave o bilateral 2. En pacientes en coma o sin respuesta se asigna el mayor d√©ficit atribuible al ictus. Solo deben puntuarse alteraciones justificables por la lesi√≥n aguda.</p>
`,
  n9:`<<p>Explora comprensi√≥n y expresi√≥n mediante denominaci√≥n, repetici√≥n y descripci√≥n de una escena. La afasia leve o moderada permite cierta comunicaci√≥n y se punt√∫a 1; la severa limita significativamente la expresi√≥n o comprensi√≥n y se punt√∫a 2; el mutismo, afasia global o coma se punt√∫an 3. En intubados debe intentarse comunicaci√≥n escrita.</p>
`,
  n10:`<p>Valora la articulaci√≥n del habla mediante lectura o repetici√≥n. La disartria leve o moderada es comprensible y punt√∫a 1; la severa produce habla ininteligible y punt√∫a 2. Si existe una barrera anat√≥mica que impide evaluar (como intubaci√≥n), no debe asignarse puntuaci√≥n y se registra como no evaluable.</p>
`,
  n11:`<p>Eval√∫a la conciencia del paciente sobre est√≠mulos visuales, t√°ctiles y espaciales. La extinci√≥n a un solo lado en una modalidad punt√∫a 1, mientras que la negligencia grave o multimodal punt√∫a 2. Comprende fen√≥menos como ignorar est√≠mulos en un hemicampo, negar la pertenencia de una extremidad o fallar repetidamente en est√≠mulos simult√°neos.</p>
`
};
const modal = document.getElementById('modal');
const modalTitle = document.getElementById('modal-title');
const modalBody = document.getElementById('modal-body');
const modalClose = document.getElementById('modal-close');

document.querySelectorAll('.help').forEach(btn=>{
  btn.addEventListener('click', ()=>{
    const key = btn.getAttribute('data-help');
    const ttl = btn.closest('.coll').querySelector('.ttl')?.textContent?.trim() || 'Ayuda';
    modalTitle.textContent = ttl;
    modalBody.innerHTML = helpTexts[key] || 'Sin ayuda disponible.';
    modal.classList.add('open');
  });
});
modalClose.addEventListener('click', ()=> modal.classList.remove('open'));
modal.addEventListener('click', (e)=>{ if(e.target===modal){ modal.classList.remove('open'); }});

/* Init */
document.addEventListener('DOMContentLoaded', actualizar);
</script>
    <footer> <img src="../img/uibanner.png" alt="Ictus GPS">
    </footer>
    <script src="js/index.js"></script>
  </body>
</html>
