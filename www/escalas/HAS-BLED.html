<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="manifest" href="../site.webmanifest">
<link rel="icon" type="image/png" sizes="192x192" href="../iconos/ictusgps.png">
<link rel="apple-touch-icon" sizes="180x180" href="../iconos/ictusgps.png">
<link rel="shortcut icon" href="../iconos/ictusgps.png">
<meta name="theme-color" content="#0f3d83">
<title>HAS-BLED — Riesgo de sangrado</title>
<style>
:root{
  --bg:#f8fafc; --ink:#0f172a; --muted:#64748b;
  --card:#ffffff; --borde:#e5e7eb;
  --accent:#0f3d83; --accent-light:#dbeafe;
  --ok:#166534; --mid:#92400e; --bad:#991b1b;
}
:root{
  --bg:#f9fafc;
  --ink:#0e1a33;
  --accent-dark:#0f3d83;
  --accent-light:#2563eb;
  --border:#e5e9f2;
  --muted:#64748b;
  --ok:#166534; --ok-bg:#e9fce7; --ok-ring:#bbf7d0;
  --mid:#92400e; --mid-bg:#fff7ed; --mid-ring:#fed7aa;
  --bad:#991b1b; --bad-bg:#fef2f2; --bad-ring:#fecaca;
  --azul-institucional:#0f3d83;
}
html,body{margin:0;padding:0;background:var(--bg);color:var(--ink);
          font-family:Verdana, Geneva, Tahoma, sans-serif;font-size:15px;}
*{box-sizing:border-box}

/* =========================================================
   SAFE-TOP
========================================================= */
.safe-top {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: calc(env(safe-area-inset-top, 0px) + 60px);
  background: var(--azul-institucional);
  z-index: 1001;
  display: flex;
  align-items: flex-start;
  justify-content: center;
  padding-top: env(safe-area-inset-top, 0px);
}
.safe-content {
  width: 100%;
  max-width: 1080px;
  padding: 6px 16px 8px;
  display: flex;
  justify-content: space-between;
  align-items: flex-start; 
  /* Añadir un padding-top para empujar los iconos ligeramente hacia abajo y no pegarlos al borde */
  padding-top: 5px; /* Ajuste manual para bajar los iconos un poco */
  padding-bottom: 0; /* Eliminar padding inferior para reservar ese espacio */
}
.safe-left {
  display: flex;
  align-items: center;
  gap: 10px;
}
.safe-mini {
  width: 44px;
  height: 44px;
  object-fit: contain;
  padding: 4px;
  box-shadow: 0 0 4px rgba(0,0,0,0.1);
}
.safe-logo {
  height: 44px;
  width: auto;
}
.safe-actions {
  display: flex;
  gap: 10px;
}
.safe-btn {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 40px;
  height: 40px;
  background: rgba(255,255,255,0.15);
  border: 1px solid white;
  border-radius: 50%;
  transition: background .25s, border-color .25s, transform .1s;
}
.safe-btn:hover {
  background: #01c5fe;
  border: 1px solid white;
}
.safe-btn:active { transform: scale(0.95); }
.safe-icon {
  width: 32px;
  height: 32px;
  object-fit: contain;
}

/* CABECERA */
header{position:sticky;
  z-index:1002;background:var(--accent);color:#fff;
  box-shadow:0 2px 6px rgba(0,0,0,.08);top: calc(env(safe-area-inset-top, 0px) + 52px);
}
.bar{display:flex;justify-content:center;align-items:center;gap:10px;
  height:52px;padding:0 16px;}
.bar h1{font-size:1.4rem;font-weight:700;margin:0;}
/* =========================================================
   CABECERA
========================================================= */
/* ... (reglas existentes) ... */
.bar {
  display:flex;
  justify-content:center;
  align-items:center;
  gap: 10px;
  height:52px;
  padding:4px 16px;
}

.bar h1 {
  display: flex; /* <-- NUEVO: Habilita flexbox para alinear el icono */
  align-items: center; /* <-- NUEVO: Centra el icono y el texto verticalmente */
  /* ... (otras reglas de title) ... */
}
.bar h1 img {
  width: 32px; /* Define el tamaño del icono */
  height: 32px;
  margin-right: 8px; /* Espacio entre el icono y el texto "ABCD²" */
}
.pill-top{
  display:inline-flex; align-items:center; justify-content:center;
padding:6px 10px;border-radius:999px;min-width:38px; height:25px;
  border:1px solid transparent; background:#dbeafe; color:#1e3a8a;  font-size:13px;font-weight:700;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;}
.pill-top.tone-green{background:#dcfce7;color:#065f46;border-color:#86efac}
.pill-top.tone-amber{background:#fef3c7;color:#92400e;border-color:#fde68a}
.pill-top.tone-red{background:#fee2e2;color:#991b1b;border-color:#fecaca}


/* INTRO */
.intro{max-width:980px;margin-inline:auto;padding:52px 16px 0;color:var(--muted);
  font-size:.95rem;line-height:1.45;text-align:justify;}
.intro strong{color:var(--accent);}
/* === Contenido === */
body{margin:0;background:var(--bg);color:var(--ink);font-family:Verdana, Geneva, sans-serif;}
.wrap{max-width:980px;margin:16px auto 48px;padding:12px 16px;}.card{background:#fff;border:1px solid var(--borde);border-radius:16px;box-shadow:0 2px 10px rgba(15,23,42,.06);padding:18px;margin-bottom:16px}
.grid{display:grid;grid-template-columns:1fr;gap:12px}
@media(min-width:720px){.grid{grid-template-columns:1fr 1fr}}
label{display:block;font-weight:700;margin:2px 0 6px;color:var(--ink)}
select{width:100%;padding:10px 12px;font-size:15px;border:1px solid var(--borde);
       border-radius:10px;background:#fff;cursor:pointer;}
select:focus{border-color:var(--accent);box-shadow:0 0 0 3px rgba(37,99,235,.15)}
.note{color:var(--muted);font-size:12px;margin-top:10px}

/* Botones */
.actions{display:flex;gap:10px;flex-wrap:wrap;margin-top:14px}
.btn{
  flex:1 1 150px;
  border:1px solid #2563eb;
  border-radius:10px;
  padding:12px;
  font-size:15px;
  font-weight:700;
  cursor:pointer;
  background:#fff;
  color:#1e3a8a;
  transition:background .2s,transform .1s,box-shadow .2s;
}
.btn:hover{background:#eff6ff;box-shadow:0 3px 8px rgba(37,99,235,.15)}
.btn.copiado{background:#0f3d83;color:#fff;border-color:#0f3d83}

/* Píldoras de riesgo */
.pill{display:inline-block;height:18px;padding:4px 8px;border-radius:999px;font-weight:700;font-size:13px;color:#fff}
.pill.green{background:var(--ok)}.pill.amber{background:var(--mid)}.pill.red{background:var(--bad)}

#resumenText{white-space:pre-wrap;font-size:13px;color:#0f172a;margin-top:8px;
             border:1px dashed var(--borde);border-radius:10px;padding:10px;background:#f8fafc}

/* Tabla interpretativa */
.tablebox{margin-top:12px;border:1px solid var(--borde);border-radius:10px;overflow:hidden}
.tablebox table{width:100%;border-collapse:collapse;font-size:13px;text-align:center}
.tablebox th{background:#e6f0ff;color:#1e3a8a;font-weight:700;padding:8px;border-bottom:1px solid var(--borde)}
.tablebox td{padding:8px;border-top:1px solid var(--borde)}
.tablebox tr:nth-child(odd){background:#fafbff}

/* Pie */
footer{
  width:100%;
  margin:2rem 0 0;
  padding:1.5rem 0;
  border-top:1px solid #e5e7eb;
  background:#ffffff;
  text-align:center;
  box-shadow:0 -2px 6px rgba(0,0,0,0.04);
}
footer img{max-width:320px;height:auto;opacity:.95}

@media(max-width:768px){
  header{font-size:1.05rem;}
  main{padding:0.9rem 1rem;}
  body{font-size:0.96rem;}
}

</style>

</head>
<body>

<div class="safe-top">
  <div class="safe-content">
    <div class="safe-left">
      <img src="../iconos/escalasico.png" alt="Icono Escalas" class="safe-mini">
      <img src="../img/topbar.png" alt="IctusGPS" class="safe-logo">
    </div>
    <div class="safe-actions">
      <a href="javascript:history.back()" class="safe-btn"><img src="../iconos/atrastransparente.png" class="safe-icon" alt="Atrás"></a>
      <a href="../index.html" class="safe-btn"><img src="../iconos/hometransparente.png" class="safe-icon" alt="Inicio"></a>
    </div>
  </div>
</div>

<header>
  <div class="bar">
    <h1><img src="../iconos/hasbled.png" alt="HAS-BLED">HAS-BLED</h1>
      <output id="pillTop" class="pill-top" aria-live="polite" aria-atomic="true">—</output>
  </div>
</header>



<main class="wrap">
<section class="intro">
  <p>Estima el <b>riesgo de hemorragia mayor a un año</b> en pacientes con <b>fibrilación auricular</b> que reciben <b>tratamiento anticoagulante</b>. Evalúa factores de riesgo modificables y no modificables, ayudando a guiar la toma de decisiones sobre la seguridad del tratamiento.</p>
</section>

  <section class="card">
    <p class="note">Complete cada ítem; el resultado y la recomendación se actualizan automáticamente.</p>

    <div class="grid">
      <div><label for="edad">Edad &gt; 65 años</label>
        <select id="edad"><option value="">Selecciona…</option><option value="1">Sí</option><option value="0">No</option></select></div>

      <div><label for="hta">Hipertensión (PAS ≥160 mmHg)</label>
        <select id="hta"><option value="">Selecciona…</option><option value="1">Sí</option><option value="0">No</option></select></div>

      <div><label for="aki">Función renal anormal</label>
        <select id="aki"><option value="">Selecciona…</option>
          <option value="1">Diálisis, trasplante renal, creatinina &gt;2,26 mg/dL (200 μmol/L) o aclaramiento &lt;30 mL/min</option>
          <option value="0">No</option></select></div>

      <div><label for="fha">Función hepática anormal</label>
        <select id="fha"><option value="">Selecciona…</option>
          <option value="1">Bilirrubina &gt;2× LSN o GOT/GPT &gt;3× LSN, hepatopatía crónica o cirrosis</option>
          <option value="0">No</option></select></div>

      <div><label for="acv">Ictus previo</label>
        <select id="acv"><option value="">Selecciona…</option><option value="1">Sí</option><option value="0">No</option></select></div>

      <div><label for="sangrado">Sangrado previo o predisposición</label>
        <select id="sangrado"><option value="">Selecciona…</option><option value="1">Sí</option><option value="0">No</option></select></div>

      <div><label for="inr">INR lábil (si en AVK)</label>
        <select id="inr"><option value="">Selecciona…</option><option value="1">Sí</option><option value="0">No / No en AVK</option></select></div>

      <div><label for="drogas">Fármacos concomitantes (AAS / AINEs)</label>
        <select id="drogas"><option value="">Selecciona…</option><option value="1">Sí</option><option value="0">No</option></select></div>

      <div><label for="alcohol">Alcohol (abuso)</label>
        <select id="alcohol"><option value="">Selecciona…</option><option value="1">Sí</option><option value="0">No</option></select></div>
    </div>

    <div class="actions">
      <button id="btnClear" class="btn" type="button">Borrar</button>
      <button id="btnCopy" class="btn" type="button">Copiar resumen</button>
    </div>

    <div id="resultado" style="margin-top:16px;display:none" aria-live="polite">
      <div class="card" style="padding:12px">
        <strong>Puntuación:</strong> <span id="score">—</span>
        <span id="chip" class="pill" style="margin-left:6px;display:none"></span>
      </div>

      <div class="tablebox">
        <table>
          <thead><tr><th>Puntuación</th><th>Riesgo estimado</th><th>Interpretación</th></tr></thead>
          <tbody>
            <tr><td>0–1</td><td>≈ 1 %/año</td><td>Bajo riesgo</td></tr>
            <tr><td>2</td><td>≈ 2 %/año</td><td>Riesgo intermedio</td></tr>
            <tr><td>≥3</td><td>≈ 3–5 %/año</td><td>Alto riesgo</td></tr>
          </tbody>
        </table>
      </div>

      <div class="card" style="padding:12px">
        <strong>Recomendación:</strong>
        <div id="textoReco" class="note">Complete los campos.</div>
      </div>

      <div id="resumenText"></div>
      <p class="note"><b>Nota:</b> HAS-BLED identifica <em>factores de riesgo modificables</em>. Un valor alto <b>no</b> contraindica por sí solo la anticoagulación.</p>
    </div>
  </section>

</main>

<script>
const ids=['edad','hta','aki','fha','acv','sangrado','inr','drogas','alcohol'];
const el=id=>document.getElementById(id);
function riesgoLabel(s){if(s>=3)return{txt:'Alto',cls:'red'};if(s==2)return{txt:'Intermedio',cls:'amber'};return{txt:'Bajo',cls:'green'};}
function recomendaciones(s,renal){
  let t='';
  if(s>=3)t='Riesgo hemorrágico alto. Optimizar factores modificables (TA, INR, fármacos, alcohol) y revaluar periódicamente.';
  else if(s==2)t='Riesgo intermedio. Vigilar y corregir factores reversibles.';
  else t='Riesgo bajo. Reevaluación periódica.';
  if(renal===1)t+=' Precaución en insuficiencia renal grave; ajustar anticoagulante según ficha técnica.';
  return t;
}
function updateHeaderPill(score,label){
  const pill=el('pillTop');
  pill.classList.remove('tone-green','tone-amber','tone-red');
  if(typeof score!=='number'||isNaN(score)){pill.textContent='—';return;}
  const tone=score>=3?'tone-red':score==2?'tone-amber':'tone-green';
  pill.classList.add(tone);
  pill.textContent=`${score} - ${label}`;
}
function leerInt(id){const v=parseInt(el(id).value,10);return isNaN(v)?null:v;}
function calcular(){
  const vals=ids.map(id=>leerInt(id));
  if(vals.some(v=>v===null)){el('resultado').style.display='none';updateHeaderPill();return;}
  const score=vals.reduce((a,b)=>a+b,0);
  const rl=riesgoLabel(score);
  const renal=leerInt('aki')||0;
  el('score').textContent=score;
  const chip=el('chip');chip.textContent=rl.txt;chip.className='pill '+rl.cls;chip.style.display='inline-block';
  const texto=recomendaciones(score,renal);
  el('textoReco').textContent=texto;
  el('resultado').style.display='block';
  updateHeaderPill(score,rl.txt);
  let resumen=`Escala HAS-BLED: ${score} puntos (${rl.txt}).\n`;
  resumen+=`Interpretación: ${texto}\n\nFactores presentes:\n`;
  ids.forEach(id=>{
    const opt=el(id);
    if(opt.value=='1'){resumen+=`- ${opt.previousElementSibling.textContent}\n`;}
  });
  el('resumenText').textContent=resumen;
}
function borrar(){ids.forEach(id=>el(id).value='');el('resultado').style.display='none';updateHeaderPill();}
function copiar(){
  const txt=el('resumenText').textContent.trim();
  if(!txt)return;
  navigator.clipboard.writeText(txt).then(()=>{
    const b=el('btnCopy');
    b.classList.add('copiado');b.textContent='Copiado';
    setTimeout(()=>{b.classList.remove('copiado');b.textContent='Copiar resumen';},3000);
  });
}
ids.forEach(id=>{el(id).addEventListener('change',calcular);el(id).addEventListener('input',calcular);});
el('btnClear').addEventListener('click',borrar);
el('btnCopy').addEventListener('click',copiar);
document.addEventListener('DOMContentLoaded',()=>updateHeaderPill());
</script>

<footer>
  <img src="../img/uibanner.png" alt="Ictus GPS">
</footer>
<script src="js/index.js"></script>
</body>
</html>
